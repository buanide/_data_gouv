i 1 value {'rdms_table': 'MON.FT_A_CNI_EXPIREES', 
'first_hive table': 'MON.SPARK_FT_A_CNI_EXPIREES', 
'liste_champs': ['NBR_TOTAL_CNI_EXP', 'NBR_TOTAL_CNI_NEW_EXP', 'NBR_TOTAL_CNI_CORRECTED', 
'NBR_TOTAL_CNI_EXP_MAX_THREE_DAYS', 'NBR_TOTAL_DATE_EXP_INV', 'CNI_EXP_MORE_THAN_SIX_MONTHS_AGO', 
'CNI_EXP_THREE_MONTHS_AGO', 'CNI_EXP_LESS_THAN_THREE_MONTHS', 'INSERT_DATE', 'SPARK_FT_A_CNI_EXPIREES',
 'PARTITIONED', 'EVENT_DATE'], 
 'dependencies': 
 {'MON.SPARK_FT_A_CNI_EXPIREES': 
 ['C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\FT\\BDI\\FT_A_CNI_EXPIREES\\insert_into_spark_ft_a_cni_expirees.hql'],
 'MON.SPARK_FT_KYC_BDI_PP': ['C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\FT\\BDI\\FT_BDI\\PP\\insert_into_kyc_bdi_pp.hql'], 
 'TMP.TT_KYC_BDI_PP_ST3': ['C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\FT\\BDI\\FT_BDI\\PP\\insert_into_kyc_bdi_pp_step3.hql'], 
 'TMP.TT_KYC_BDI_PP_ST2': ['C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\FT\\BDI\\FT_BDI\\PP\\insert_into_kyc_bdi_pp_step2.hql'], 
 'TMP.TT_KYC_BDI_PP_ST1': ['C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\FT\\BDI\\FT_BDI\\PP\\insert_into_kyc_bdi_pp_step1.hql'],
  'MON.SPARK_FT_MARKETING_DATAMART_MONTH': ['C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\FT\\DATAMART\\FT_MARKETING_DATAMART_MONTH\\compute_and_insert_into_spark_ft_marketing_datamart_month.hql'], 'MON.SPARK_FT_MARKETING_DATAMART': ['C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\FT\\DATAMART\\FT_MARKETING_DATAMART\\compute_and_insert_into_spark_ft_marketing_datamart.hql'], 'MON.SPARK_FT_CLIENT_360': ['C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\FT\\CLIENT360\\compute_and_insert_into_spark_ft_client_360.hql'], 'MON.SPARK_FT_BDI': ['C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\FT\\BDI\\FT_BDI_1A\\insert_into_spark_ft_bdi2.hql'], 'TMP.TT_FT_BDI_III_1A': ['C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\FT\\BDI\\FT_BDI_1A\\insert_into_tt_ft_bdi_III2.hql'], 'TMP.TT_FT_BDI_II_1A': ['C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\FT\\BDI\\FT_BDI_1A\\insert_into_tt_ft_bdi_II2.hql'], 'TMP.TT_FT_BDI_1A': ['C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\FT\\BDI\\FT_BDI_1A\\insert_into_tt_ft_bdi2.hql'], 'CDR.SPARK_IT_BDI': ['C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\IT\\BDI\\IT_BDI\\insert_into_spark_it_bdi.hql', 'C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\IT\\BDI2\\insert2_into_spark_it_bdi.hql'], 'TMP.TT_KYC_PERS_PHY_B2C_ACTIVE': None, 'TMP.TT_KYC_PERS_PHY_B2C_FINAL': None, 'TMP.TT_KYC_PERS_PHY_B2C_COMPLETE': None, 'CDR.SPARK_IT_BDI_LIGNE_FLOTTE': ['C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\IT\\BDI\\IT_BDI_LIGNE_FLOTTE\\insert_into_spark_it_bdi_ligne_flotte.hql', 'C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\IT\\BDI2\\insert2_into_spark_it_bdi_ligne_flotte.hql', 'C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\IT\\BDI2\\insert_into_spark_it_bdi_flotte_multitism_generique.hql'], 'TMP.TT_BDI_LIGNE_FLOTTE2_1C': ['C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\IT\\BDI2\\insert_into_tt_bdi_ligne_flotte2_1c.hql'], 'TMP.TT_BDI_LIGNE_FLOTTE2_1B': ['C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\IT\\BDI2\\insert_into_tt_bdi_ligne_flotte2_1b.hql'], 'TMP.TT_BDI_LIGNE_FLOTTE2_1A': ['C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\IT\\BDI2\\insert2_into_tt_bdi_ligne_flotte2.hql'], 'TMP.TT_BDI_FLOTTE_1A': ['C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\IT\\BDI2\\insert2_into_tt_bdi_flotte.hql', 'C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\IT\\BDI2\\insert2_into_tt_bdi_flotte_1b.hql', 'C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\IT\\BDI2\\insert2_into_tt_bdi_flotte_plus.hql', 'C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\IT\\BDI2\\insert2_stk_flotte_into_tt_bdi_flotte.hql'], 'TMP.TT_BDI_1A': ['C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\IT\\BDI2\\insert2_into_tt_bdi.hql'], 'TMP.TT_BDI_TMP1_1A': ['C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\IT\\BDI2\\insert2_into_spark_remove_no_zsmart_to_bdi_tmp.hql'], 'MON.SPARK_FT_MSISDN_IMEI_LOCALISATION_TO_BDI': ['C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\FT\\BDI\\FT_MSISDN_IMEI_LOCALISATION_TO_BDI\\insert_into_spark_ft_msisdn_imei_localisation_bdi.hql'], 'TMP.TT_LOCALISATION_BDI2': ['C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\FT\\BDI\\FT_MSISDN_IMEI_LOCALISATION_TO_BDI\\insert_into_tt_bdi_localisation2.hql'], 'DIM.SPARK_DT_OFFER_PROFILES': None, None: None}}




{'MON.SPARK_FT_A_CNI_EXPIREES': 
 ['C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\FT\\BDI\\FT_A_CNI_EXPIREES\\insert_into_spark_ft_a_cni_expirees.hql'],
 'MON.SPARK_FT_KYC_BDI_PP':{'path':'C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\FT\\BDI\\FT_BDI\\PP\\insert_into_kyc_bdi_pp.hql','depht':} [], 
 'TMP.TT_KYC_BDI_PP_ST3': ['C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\FT\\BDI\\FT_BDI\\PP\\insert_into_kyc_bdi_pp_step3.hql'], 
 'TMP.TT_KYC_BDI_PP_ST2': ['C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\FT\\BDI\\FT_BDI\\PP\\insert_into_kyc_bdi_pp_step2.hql'], 
 'TMP.TT_KYC_BDI_PP_ST1': ['C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\FT\\BDI\\FT_BDI\\PP\\insert_into_kyc_bdi_pp_step1.hql'],
  'MON.SPARK_FT_MARKETING_DATAMART_MONTH': ['C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\FT\\DATAMART\\FT_MARKETING_DATAMART_MONTH\\compute_and_insert_into_spark_ft_marketing_datamart_month.hql'], 'MON.SPARK_FT_MARKETING_DATAMART': ['C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\FT\\DATAMART\\FT_MARKETING_DATAMART\\compute_and_insert_into_spark_ft_marketing_datamart.hql'], 'MON.SPARK_FT_CLIENT_360': ['C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\FT\\CLIENT360\\compute_and_insert_into_spark_ft_client_360.hql'], 'MON.SPARK_FT_BDI': ['C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\FT\\BDI\\FT_BDI_1A\\insert_into_spark_ft_bdi2.hql'], 'TMP.TT_FT_BDI_III_1A': ['C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\FT\\BDI\\FT_BDI_1A\\insert_into_tt_ft_bdi_III2.hql'], 'TMP.TT_FT_BDI_II_1A': ['C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\FT\\BDI\\FT_BDI_1A\\insert_into_tt_ft_bdi_II2.hql'], 'TMP.TT_FT_BDI_1A': ['C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\FT\\BDI\\FT_BDI_1A\\insert_into_tt_ft_bdi2.hql'], 'CDR.SPARK_IT_BDI': ['C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\IT\\BDI\\IT_BDI\\insert_into_spark_it_bdi.hql', 'C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\IT\\BDI2\\insert2_into_spark_it_bdi.hql'], 'TMP.TT_KYC_PERS_PHY_B2C_ACTIVE': None, 'TMP.TT_KYC_PERS_PHY_B2C_FINAL': None, 'TMP.TT_KYC_PERS_PHY_B2C_COMPLETE': None, 'CDR.SPARK_IT_BDI_LIGNE_FLOTTE': ['C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\IT\\BDI\\IT_BDI_LIGNE_FLOTTE\\insert_into_spark_it_bdi_ligne_flotte.hql', 'C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\IT\\BDI2\\insert2_into_spark_it_bdi_ligne_flotte.hql', 'C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\IT\\BDI2\\insert_into_spark_it_bdi_flotte_multitism_generique.hql'], 'TMP.TT_BDI_LIGNE_FLOTTE2_1C': ['C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\IT\\BDI2\\insert_into_tt_bdi_ligne_flotte2_1c.hql'], 'TMP.TT_BDI_LIGNE_FLOTTE2_1B': ['C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\IT\\BDI2\\insert_into_tt_bdi_ligne_flotte2_1b.hql'], 'TMP.TT_BDI_LIGNE_FLOTTE2_1A': ['C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\IT\\BDI2\\insert2_into_tt_bdi_ligne_flotte2.hql'], 'TMP.TT_BDI_FLOTTE_1A': ['C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\IT\\BDI2\\insert2_into_tt_bdi_flotte.hql', 'C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\IT\\BDI2\\insert2_into_tt_bdi_flotte_1b.hql', 'C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\IT\\BDI2\\insert2_into_tt_bdi_flotte_plus.hql', 'C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\IT\\BDI2\\insert2_stk_flotte_into_tt_bdi_flotte.hql'], 'TMP.TT_BDI_1A': ['C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\IT\\BDI2\\insert2_into_tt_bdi.hql'], 'TMP.TT_BDI_TMP1_1A': ['C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\IT\\BDI2\\insert2_into_spark_remove_no_zsmart_to_bdi_tmp.hql'], 'MON.SPARK_FT_MSISDN_IMEI_LOCALISATION_TO_BDI': ['C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\FT\\BDI\\FT_MSISDN_IMEI_LOCALISATION_TO_BDI\\insert_into_spark_ft_msisdn_imei_localisation_bdi.hql'], 'TMP.TT_LOCALISATION_BDI2': ['C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\FT\\BDI\\FT_MSISDN_IMEI_LOCALISATION_TO_BDI\\insert_into_tt_bdi_localisation2.hql'], 'DIM.SPARK_DT_OFFER_PROFILES': None, None: None}}






 {'rdms_table': 'MON.FT_GLOBAL_ACTIVITY_DAILY',
  'first_hive table': 'AGG.SPARK_FT_GLOBAL_ACTIVITY_DAILY', 
  'liste_champs': ['COMMERCIAL_OFFER_CODE', 
  'TRANSACTION_TYPE', 'SUB_ACCOUNT', 'TRANSACTION_SIGN',
   'SOURCE_PLATFORM', 'SOURCE_DATA', 'SERVED_SERVICE', 
   'SERVICE_CODE', 'DESTINATION', 'OTHER_PARTY_ZONE', 'MEASUREMENT_UNIT', 
   'RATED_COUNT', 'RATED_VOLUME', 'TAXED_AMOUNT', 'UNTAXED_AMOUNT', 'INSERT_DATE',
    'TRAFFIC_MEAN', 'OPERATOR_CODE', 'LOCATION_CI', 'SPARK_FT_GLOBAL_ACTIVITY_DAILY', 
    'PARTITIONED', 'TRANSACTION_DATE'], 'staging_table_dwh': 'MON.SQ_TMP_FT_GLOBAL_ATV_DAILY_EX',
     'dependencies': 
     {'AGG.SPARK_FT_GLOBAL_ACTIVITY_DAILY': {'path': 
     ['C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\REPORT\\GLOBAL_ACTIVITY\\spark_compute_and_insert_adjustement_activity.hql', 'C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\REPORT\\GLOBAL_ACTIVITY\\spark_compute_and_insert_contract_snapshot_activity.hql', 'C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\REPORT\\GLOBAL_ACTIVITY\\spark_compute_and_insert_credit_transfer_activity.hql', 'C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\REPORT\\GLOBAL_ACTIVITY\\spark_compute_and_insert_data_transfer_activity.hql', 'C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\REPORT\\GLOBAL_ACTIVITY\\spark_compute_and_insert_emergency_data_activity.hql', 'C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\REPORT\\GLOBAL_ACTIVITY\\spark_compute_and_insert_emergency_voice_loan.hql', 'C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\REPORT\\GLOBAL_ACTIVITY\\spark_compute_and_insert_gprs_activity.hql', 'C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\REPORT\\GLOBAL_ACTIVITY\\spark_compute_and_insert_gprs_post_activity.hql', 'C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\REPORT\\GLOBAL_ACTIVITY\\spark_compute_and_insert_gsm_activity.hql', 'C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\REPORT\\GLOBAL_ACTIVITY\\spark_compute_and_insert_gsm_post_activity.hql', 'C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\REPORT\\GLOBAL_ACTIVITY\\spark_compute_and_insert_overdraft_activity.hql', 'C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\REPORT\\GLOBAL_ACTIVITY\\spark_compute_and_insert_refill_activity.hql', 'C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\REPORT\\GLOBAL_ACTIVITY\\spark_compute_and_insert_subsc_activity.hql', 'C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\REPORT\\GLOBAL_ACTIVITY\\spark_compute_and_insert_subsc_retail_zebra_activity.hql'],
     
      'position': 1}, 'MON.SPARK_FT_EMERGENCY_DATA': {'path': ['C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\FT\\IN_ZTE\\EMERGENCY_DATA\\compute_and_insert_into_spark_ft_emergency_data.hql'], 'position': 2}, 'MON.SPARK_FT_CONTRACT_SNAPSHOT': {'path': ['C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\FT\\IN_ZTE\\insert_into_spark_ft_contract_snapshot.hql'], 'position': 3}, 'CDR.SPARK_IT_ZTE_ACC_NBR_EXTRACT': {'path': ['C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\IT\\IN_ZTE\\EXTRACT\\insert_into_spark_it_zte_acc_nbr_extract.hql'], 
     'position': 4},
      'CDR.TT_ZTE_ACC_NBR_EXTRACT': 
      {'path': None, 'position': 5}, 
'/PROD/RAW/IN_ZTE/ACC_NBR_EXTRACT/Data_*': {'path': None, 'position': 6}}}
dependencies {'AGG.SPARK_FT_GLOBAL_ACTIVITY_DAILY': {'path': ['C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\REPORT\\GLOBAL_ACTIVITY\\spark_compute_and_insert_adjustement_activity.hql', 'C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\REPORT\\GLOBAL_ACTIVITY\\spark_compute_and_insert_contract_snapshot_activity.hql', 'C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\REPORT\\GLOBAL_ACTIVITY\\spark_compute_and_insert_credit_transfer_activity.hql', 'C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\REPORT\\GLOBAL_ACTIVITY\\spark_compute_and_insert_data_transfer_activity.hql', 'C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\REPORT\\GLOBAL_ACTIVITY\\spark_compute_and_insert_emergency_data_activity.hql', 'C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\REPORT\\GLOBAL_ACTIVITY\\spark_compute_and_insert_emergency_voice_loan.hql', 'C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\REPORT\\GLOBAL_ACTIVITY\\spark_compute_and_insert_gprs_activity.hql', 'C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\REPORT\\GLOBAL_ACTIVITY\\spark_compute_and_insert_gprs_post_activity.hql', 'C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\REPORT\\GLOBAL_ACTIVITY\\spark_compute_and_insert_gsm_activity.hql', 'C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\REPORT\\GLOBAL_ACTIVITY\\spark_compute_and_insert_gsm_post_activity.hql', 'C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\REPORT\\GLOBAL_ACTIVITY\\spark_compute_and_insert_overdraft_activity.hql', 'C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\REPORT\\GLOBAL_ACTIVITY\\spark_compute_and_insert_refill_activity.hql', 'C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\REPORT\\GLOBAL_ACTIVITY\\spark_compute_and_insert_subsc_activity.hql', 'C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\REPORT\\GLOBAL_ACTIVITY\\spark_compute_and_insert_subsc_retail_zebra_activity.hql'], 'position': 1}, 'MON.SPARK_FT_EMERGENCY_DATA': {'path': ['C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\FT\\IN_ZTE\\EMERGENCY_DATA\\compute_and_insert_into_spark_ft_emergency_data.hql'], 'position': 2}, 'MON.SPARK_FT_CONTRACT_SNAPSHOT': {'path': ['C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\FT\\IN_ZTE\\insert_into_spark_ft_contract_snapshot.hql'], 'position': 3}, 'CDR.SPARK_IT_ZTE_ACC_NBR_EXTRACT': {'path': ['C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\IT\\IN_ZTE\\EXTRACT\\insert_into_spark_it_zte_acc_nbr_extract.hql'], 'position': 4}, 'CDR.TT_ZTE_ACC_NBR_EXTRACT': {'path': None, 'position': 5}, '/PROD/RAW/IN_ZTE/ACC_NBR_EXTRACT/Data_*': {'path': None, 'position': 6}}
-------------------------------------------------------------------------------------------------------






  alias=info.get("Alias/Projection", None)
                                    alias_upper=alias.upper()
                                    if alias!=None:
                                        # on regarde si l'alias est dans la liste des champs des champs
                                        #  de dernière table d'aggrégation avant l'insertion dans la table rdms
                                        if  alias_upper in fields_first_hive_table:
                                            #print("alias in fields_first_hive_table")
                                            try:    
                                               # on se rassure que les deux listes de champs ont la même taille 
                                                print("rdms_table_name",rdms_table_name)
                                                print("fields_rdms taille",len(fields_rdms_tmp),"fields_rdms_temp taille",len(fields_rdms))
                                                print("fields_rdms_temps ",fields_rdms_tmp)
                                                print("")
                                                print("fields_temps ",fields_rdms)
                                                #print()
                                                if len(fields_rdms_tmp)==len(fields_rdms):
                                                     print("same size")
                                                     indice = fields_first_hive_table.index(alias_upper)  # 25 n'est pas dans la liste
                                                     rdms_field=fields_rdms[indice]
                                                     print("rdms_field",rdms_field)
                                                     print("alias",alias)
                                                     field_entry = {
                                                        "path": "",
                                                        "colonne": rdms_field,
                                                        "Opérations arithmétiques": "",
                                                        "Alias": alias,
                                                        "Formule SQL": "",
                                                        "Table(s) utilisées": ""
                                                    }
                                                     overall_field_tracking[col].append(field_entry)
                                            except ValueError:
                                                print("L'alias n'est pas dans la liste des champs de la table")


-------------------------------------------------------------------------------------------------------

lineage {'C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\FT\\IN_ZTE\\TRANSFER\\compute_and_insert_into_spark_ft_a_data_transfer.hql': 
{'C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\FT\\IN_ZTE\\TRANSFER\\compute_and_insert_into_spark_ft_a_data_transfer.hql': 
{'nb_transfers': {'Alias/Projection': 'nb_transfers', 'Colonnes détectées': [], 'agg': ['COUNT'], 'Opérations arithmétiques': [], 'Formule SQL': 'COUNT(*)', 'Table(s) utilisées': 'mon.spark_ft_data_transfer'}, 'bytes_debited': {'Alias/Projection': 'bytes_debited', 'Colonnes détectées': ['bytes_debited'], 'agg': ['SUM'], 'Opérations arithmétiques': [], 'Formule SQL': 'SUM(`a`.`bytes_debited`)', 'Table(s) utilisées': 'mon.spark_ft_data_transfer'}, 'bytes_credited': {'Alias/Projection': 'bytes_credited', 'Colonnes détectées': ['bytes_credited'], 'agg': ['SUM'], 'Opérations arithmétiques': [], 'Formule SQL': 'SUM(`a`.`bytes_credited`)', 'Table(s) utilisées': 'mon.spark_ft_data_transfer'}, 'montant_frais': {'Alias/Projection': 'montant_frais', 'Colonnes détectées': ['amount_charged'], 'agg': ['SUM'], 'Opérations arithmétiques': [], 'Formule SQL': 'SUM(`a`.`amount_charged`)', 'Table(s) utilisées': 'mon.spark_ft_data_transfer'}, 'bundle': {'Alias/Projection': 'bundle', 'Colonnes détectées': ['amount_charged', 'amount_charged', 'amount_charged'], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': "(CASE WHEN `a`.`amount_charged` = 10 THEN '1 - 75 Mo' WHEN `a`.`amount_charged` = 25 THEN '76 - 200 Mo' WHEN `a`.`amount_charged` = 50 THEN '201 - 500 Mo' ELSE 'AUTRES' END)", 'Table(s) utilisées': 'mon.spark_ft_data_transfer'}, 'nb_distinct_daily_senders': {'Alias/Projection': 'nb_distinct_daily_senders', 'Colonnes détectées': ['count_sender_msisdn'], 'agg': ['MAX'], 'Opérations arithmétiques': [], 'Formule SQL': 'MAX(`tmp1`.`count_sender_msisdn`)', 'Table(s) utilisées': 'mon.spark_ft_data_transfer'}, 'nb_distinct_daily_receivers': {'Alias/Projection': 'nb_distinct_daily_receivers', 'Colonnes détectées': ['count_receiver_msisdn'], 'agg': ['MAX'], 'Opérations arithmétiques': [], 'Formule SQL': 'MAX(`tmp2`.`count_receiver_msisdn`)', 'Table(s) utilisées': 'mon.spark_ft_data_transfer'}, 'nb_distinct_daily_users': {'Alias/Projection': 'nb_distinct_daily_users', 'Colonnes détectées': ['count_distinct_daily_users'], 'agg': ['MAX'], 'Opérations arithmétiques': [], 'Formule SQL': 'MAX(`tmp3`.`count_distinct_daily_users`)', 'Table(s) utilisées': 'mon.spark_ft_data_transfer'}, 'sender_operator_code': {'Alias/Projection': 'sender_operator_code', 'Colonnes détectées': ['sender_operator_code'], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': '`a`.`sender_operator_code`', 'Table(s) utilisées': 'mon.spark_ft_data_transfer'}, 'receiver_operator_code': {'Alias/Projection': 'receiver_operator_code', 'Colonnes détectées': ['receiver_operator_code'], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': '`a`.`receiver_operator_code`', 'Table(s) utilisées': 'mon.spark_ft_data_transfer'}, 'sender_offer_profile_code': {'Alias/Projection': 'sender_offer_profile_code', 'Colonnes détectées': ['sender_offer_profile_code'], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': '`a`.`sender_offer_profile_code`', 'Table(s) utilisées': 'mon.spark_ft_data_transfer'}, 'receiver_offer_profile_code': {'Alias/Projection': 'receiver_offer_profile_code', 'Colonnes détectées': ['receiver_offer_profile_code'], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': '`a`.`receiver_offer_profile_code`', 'Table(s) utilisées': 'mon.spark_ft_data_transfer'}, 'insert_date': {'Alias/Projection': 'insert_date', 'Colonnes détectées': [], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': 'CURRENT_TIMESTAMP()', 'Table(s) utilisées': 'mon.spark_ft_data_transfer'}, 'event_date': {'Alias/Projection': 'event_date', 'Colonnes détectées': ['transaction_date'], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': '`a`.`transaction_date`', 'Table(s) utilisées': 'mon.spark_ft_data_transfer'}, '*': {'Alias/Projection': '*', 'Colonnes détectées': [], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': '*', 'Table(s) utilisées': 'mon.spark_ft_data_transfer'}, 'count_sender_msisdn': {'Alias/Projection': 'count_sender_msisdn', 'Colonnes détectées': ['sender_msisdn'], 'agg': ['COUNT'], 'Opérations arithmétiques': [], 'Formule SQL': 'COUNT(DISTINCT `spark_ft_data_transfer`.`sender_msisdn`)', 'Table(s) utilisées': 'mon.spark_ft_data_transfer'}, 'count_receiver_msisdn': {'Alias/Projection': 'count_receiver_msisdn', 'Colonnes détectées': ['receiver_msisdn'], 'agg': ['COUNT'], 'Opérations arithmétiques': [], 'Formule SQL': 'COUNT(DISTINCT `spark_ft_data_transfer`.`receiver_msisdn`)', 'Table(s) utilisées': 'mon.spark_ft_data_transfer'}, 'count_distinct_daily_users': {'Alias/Projection': 'count_distinct_daily_users', 'Colonnes détectées': ['msisdn'], 'agg': ['COUNT'], 'Opérations arithmétiques': [], 'Formule SQL': 'COUNT(DISTINCT `t`.`msisdn`)', 'Table(s) utilisées': 'mon.spark_ft_data_transfer'}, 'msisdn': {'Alias/Projection': 'msisdn', 'Colonnes détectées': ['sender_msisdn'], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': '`spark_ft_data_transfer`.`sender_msisdn`', 'Table(s) utilisées': 'mon.spark_ft_data_transfer'}}, 
'position': 1}, 

'C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\FT\\IN_ZTE\\TRANSFER\\compute_and_insert_into_spark_ft_data_transfer.hql': {'C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\FT\\IN_ZTE\\TRANSFER\\compute_and_insert_into_spark_ft_data_transfer.hql': {'transaction_time': {'Alias/Projection': 'transaction_time', 'Colonnes détectées': ['nq_create_date'], 'agg': ['MAX'], 'Opérations arithmétiques': [], 'Formule SQL': "MAX(DATE_FORMAT(`a`.`nq_create_date`, 'HH:mm:ss'))", 'Table(s) utilisées': 'cdr.spark_it_zte_adjustment'}, 'transaction_id': {'Alias/Projection': 'transaction_id', 'Colonnes détectées': ['transactionsn'], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': 
'SUBSTRING(`a`.`transactionsn`, 0, 19)', 'Table(s) utilisées': 'cdr.spark_it_zte_adjustment'},
 'sender_msisdn': {'Alias/Projection': 'sender_msisdn', 'Colonnes détectées': ['acc_nbr', 'transactionsn'], 'agg': ['MAX'], 'Opérations arithmétiques': [], 'Formule SQL': "GET_NNP_MSISDN(MAX(CASE WHEN TRIM(SUBSTRING(`a`.`transactionsn`, 20)) IN ('SD', 'BD') THEN `a`.`acc_nbr` ELSE NULL END))", 'Table(s) utilisées': 'cdr.spark_it_zte_adjustment'}, 'receiver_msisdn': {'Alias/Projection': 'receiver_msisdn', 'Colonnes détectées': ['acc_nbr', 'transactionsn'], 'agg': ['MAX'], 'Opérations arithmétiques': [], 'Formule SQL': "GET_NNP_MSISDN(MAX(CASE WHEN TRIM(SUBSTRING(`a`.`transactionsn`, 20)) = 'R' THEN `a`.`acc_nbr` ELSE NULL END))", 'Table(s) utilisées': 'cdr.spark_it_zte_adjustment'}, 'amount_charged': {'Alias/Projection': 'amount_charged', 'Colonnes détectées': ['charge', 'acct_res_code', 'transactionsn'], 'agg': ['SUM'], 'Opérations arithmétiques': ['/'], 'Formule SQL': "SUM(CASE WHEN TRIM(SUBSTRING(`a`.`transactionsn`, 20)) IN ('SF', 'BF') AND `a`.`acct_res_code` = 1 THEN `a`.`charge` / 100 ELSE 0 END)", 'Table(s) utilisées': 'cdr.spark_it_zte_adjustment'}, 'bytes_debited': {'Alias/Projection': 'bytes_debited', 'Colonnes détectées': ['charge', 'transactionsn'], 'agg': ['SUM'], 'Opérations arithmétiques': [], 'Formule SQL': "SUM(CASE WHEN TRIM(SUBSTRING(`a`.`transactionsn`, 20)) IN ('SD', 'BD') THEN `a`.`charge` ELSE 0 END)", 'Table(s) utilisées': 'cdr.spark_it_zte_adjustment'}, 'bytes_credited': {'Alias/Projection': 'bytes_credited', 'Colonnes détectées': ['charge', 'transactionsn'], 'agg': ['SUM'], 'Opérations arithmétiques': [], 'Formule SQL': "SUM(CASE WHEN TRIM(SUBSTRING(`a`.`transactionsn`, 20)) = 'R' THEN `a`.`charge` ELSE 0 END)", 'Table(s) utilisées': 'cdr.spark_it_zte_adjustment'}, 'debit_act_res_code': {'Alias/Projection': 'debit_act_res_code', 'Colonnes détectées': ['acct_res_code', 'transactionsn'], 'agg': ['MAX'], 'Opérations arithmétiques': [], 'Formule SQL': "MAX(CASE WHEN TRIM(SUBSTRING(`a`.`transactionsn`, 20)) IN ('SD', 'BD') THEN `a`.`acct_res_code` ELSE NULL END)", 'Table(s) utilisées': 'cdr.spark_it_zte_adjustment'}, 'credit_act_res_code': {'Alias/Projection': 'credit_act_res_code', 'Colonnes détectées': ['acct_res_code', 'transactionsn'], 'agg': ['MAX'], 'Opérations arithmétiques': [], 'Formule SQL': "MAX(CASE WHEN TRIM(SUBSTRING(`a`.`transactionsn`, 20)) = 'R' THEN `a`.`acct_res_code` ELSE NULL END)", 'Table(s) utilisées': 'cdr.spark_it_zte_adjustment'}, 'sender_operator_code': {'Alias/Projection': 'sender_operator_code', 'Colonnes détectées': ['acc_nbr', 'transactionsn'], 'agg': ['MAX'], 'Opérations arithmétiques': [], 'Formule SQL': "GET_OPERATOR_CODE(MAX(CASE WHEN TRIM(SUBSTRING(`a`.`transactionsn`, 20)) IN ('SD', 'BD') THEN `a`.`acc_nbr` ELSE NULL END))", 'Table(s) utilisées': 'cdr.spark_it_zte_adjustment'}, 'receiver_operator_code': {'Alias/Projection': 'receiver_operator_code', 'Colonnes détectées': ['acc_nbr', 'transactionsn'], 'agg': ['MAX'], 'Opérations arithmétiques': [], 'Formule SQL': "GET_OPERATOR_CODE(MAX(CASE WHEN TRIM(SUBSTRING(`a`.`transactionsn`, 20)) = 'R' THEN `a`.`acc_nbr` ELSE NULL END))", 'Table(s) utilisées': 'cdr.spark_it_zte_adjustment'}, 'sender_offer_profile_code': {'Alias/Projection': 'sender_offer_profile_code', 'Colonnes détectées': ['profile', 'osp_customer_formule'], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': 'COALESCE(`b`.`profile`, `b`.`osp_customer_formule`)', 'Table(s) utilisées': 'cdr.spark_it_zte_adjustment, mon.spark_ft_contract_snapshot'}, 'receiver_offer_profile_code': {'Alias/Projection': 'receiver_offer_profile_code', 'Colonnes détectées': ['profile', 'osp_customer_formule'], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': 'COALESCE(`c`.`profile`, `c`.`osp_customer_formule`)', 'Table(s) utilisées': 'cdr.spark_it_zte_adjustment, mon.spark_ft_contract_snapshot'}, 'insert_date': {'Alias/Projection': 'insert_date', 'Colonnes détectées': [], 'agg': [], 'Op��rations arithmétiques': [], 'Formule SQL': 'CURRENT_TIMESTAMP()', 'Table(s) utilisées': 'cdr.spark_it_zte_adjustment, mon.spark_ft_contract_snapshot'}, 'transaction_date': {'Alias/Projection': 'transaction_date', 'Colonnes détectées': ['create_date'], 'agg': ['MAX'], 'Opérations arithmétiques': [], 'Formule SQL': 'MAX(`a`.`create_date`)', 'Table(s) utilisées': 'cdr.spark_it_zte_adjustment'}, '*': {'Alias/Projection': '*', 'Colonnes détectées': [], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': '*', 'Table(s) utilisées': 'mon.spark_ft_contract_snapshot'}},
  'position': 2},
  'C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\FT\\IN_ZTE\\insert_into_spark_ft_contract_snapshot.hql': {'C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\FT\\IN_ZTE\\insert_into_spark_ft_contract_snapshot.hql': {'contract_id': {'Alias/Projection': 'contract_id', 'Colonnes détectées': ['contract_id'], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': '`bscs_contract`.`contract_id`', 'Table(s) utilisées': 'cdr.spark_it_zte_cust_extract, mon.spark_ft_client_last_site_day, mon.ft_bscs_contract, cdr.spark_it_zte_acct_extract, cdr.spark_it_zte_bal_extract, mon.spark_ft_client_site_traffic_day, cdr.spark_it_zte_acc_nbr_extract, cdr.spark_it_zte_subs_extract, cdr.spark_it_zte_prod_extract, dim.spark_dt_gsm_cell_code, cdr.spark_it_zte_price_plan_extract, dim.dt_balance_type_item, dim.spark_dt_offer_profiles, mon.spark_ft_contract_snapshot'}, 'customer_id': {'Alias/Projection': 'customer_id', 'Colonnes détectées': ['customer_id'], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': '`bscs_contract`.`customer_id`', 'Table(s) utilisées': 'cdr.spark_it_zte_cust_extract, mon.spark_ft_client_last_site_day, mon.ft_bscs_contract, cdr.spark_it_zte_acct_extract, cdr.spark_it_zte_bal_extract, mon.spark_ft_client_site_traffic_day, cdr.spark_it_zte_acc_nbr_extract, cdr.spark_it_zte_subs_extract, cdr.spark_it_zte_prod_extract, dim.spark_dt_gsm_cell_code, cdr.spark_it_zte_price_plan_extract, dim.dt_balance_type_item, dim.spark_dt_offer_profiles, mon.spark_ft_contract_snapshot'}, 'access_key': {'Alias/Projection': 'access_key', 'Colonnes détectées': ['access_key'], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': '`spark_ft_contract_snapshot`.`access_key`', 'Table(s) utilisées': 'mon.spark_ft_contract_snapshot'}, 'account_id': {'Alias/Projection': 'account_id', 'Colonnes détectées': ['acct_id'], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': '`zte`.`acct_id`', 'Table(s) utilisées': 'cdr.spark_it_zte_cust_extract, mon.spark_ft_client_last_site_day, mon.ft_bscs_contract, cdr.spark_it_zte_acct_extract, cdr.spark_it_zte_bal_extract, mon.spark_ft_client_site_traffic_day, cdr.spark_it_zte_acc_nbr_extract, cdr.spark_it_zte_subs_extract, cdr.spark_it_zte_prod_extract, dim.spark_dt_gsm_cell_code, cdr.spark_it_zte_price_plan_extract, dim.dt_balance_type_item, dim.spark_dt_offer_profiles, mon.spark_ft_contract_snapshot'}, 'activation_date': {'Alias/Projection': 'activation_date', 'Colonnes détectées': ['completed_date'], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': 'TO_DATE(`zte`.`completed_date`)', 'Table(s) utilisées': 'cdr.spark_it_zte_cust_extract, mon.spark_ft_client_last_site_day, mon.ft_bscs_contract, cdr.spark_it_zte_acct_extract, cdr.spark_it_zte_bal_extract, mon.spark_ft_client_site_traffic_day, cdr.spark_it_zte_acc_nbr_extract, cdr.spark_it_zte_subs_extract, cdr.spark_it_zte_prod_extract, dim.spark_dt_gsm_cell_code, cdr.spark_it_zte_price_plan_extract, dim.dt_balance_type_item, dim.spark_dt_offer_profiles, mon.spark_ft_contract_snapshot'}, 'deactivation_date': {'Alias/Projection': 'deactivation_date', 'Colonnes détectées': ['main_balance_exp_date'], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': 'DATE_ADD(`bal`.`main_balance_exp_date`, 30)', 'Table(s) utilisées': 'cdr.spark_it_zte_cust_extract, cdr.spark_it_zte_acct_extract, cdr.spark_it_zte_bal_extract, cdr.spark_it_zte_acc_nbr_extract, cdr.spark_it_zte_subs_extract, cdr.spark_it_zte_prod_extract, cdr.spark_it_zte_price_plan_extract, dim.dt_balance_type_item'}, 'inactivity_begin_date': {'Alias/Projection': 'inactivity_begin_date', 'Colonnes détectées': [], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': 'NULL', 'Table(s) utilisées': 'cdr.spark_it_zte_cust_extract, mon.spark_ft_client_last_site_day, mon.ft_bscs_contract, cdr.spark_it_zte_acct_extract, cdr.spark_it_zte_bal_extract, mon.spark_ft_client_site_traffic_day, cdr.spark_it_zte_acc_nbr_extract, cdr.spark_it_zte_subs_extract, cdr.spark_it_zte_prod_extract, dim.spark_dt_gsm_cell_code, cdr.spark_it_zte_price_plan_extract, dim.dt_balance_type_item, dim.spark_dt_offer_profiles, mon.spark_ft_contract_snapshot'}, 'blocked': {'Alias/Projection': 'blocked', 'Colonnes détectées': [], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': 'NULL', 'Table(s) utilisées': 'cdr.spark_it_zte_cust_extract, mon.spark_ft_client_last_site_day, mon.ft_bscs_contract, cdr.spark_it_zte_acct_extract, cdr.spark_it_zte_bal_extract, mon.spark_ft_client_site_traffic_day, cdr.spark_it_zte_acc_nbr_extract, cdr.spark_it_zte_subs_extract, cdr.spark_it_zte_prod_extract, dim.spark_dt_gsm_cell_code, cdr.spark_it_zte_price_plan_extract, dim.dt_balance_type_item, dim.spark_dt_offer_profiles, mon.spark_ft_contract_snapshot'}, 'exhausted': {'Alias/Projection': 'exhausted', 'Colonnes détectées': [], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': 'NULL', 'Table(s) utilisées': 'cdr.spark_it_zte_cust_extract, mon.spark_ft_client_last_site_day, mon.ft_bscs_contract, cdr.spark_it_zte_acct_extract, cdr.spark_it_zte_bal_extract, mon.spark_ft_client_site_traffic_day, cdr.spark_it_zte_acc_nbr_extract, cdr.spark_it_zte_subs_extract, cdr.spark_it_zte_prod_extract, dim.spark_dt_gsm_cell_code, cdr.spark_it_zte_price_plan_extract, dim.dt_balance_type_item, dim.spark_dt_offer_profiles, mon.spark_ft_contract_snapshot'}, 'periodic_fee': {'Alias/Projection': 'periodic_fee', 'Colonnes détectées': [], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': 'NULL', 'Table(s) utilisées': 'cdr.spark_it_zte_cust_extract, mon.spark_ft_client_last_site_day, mon.ft_bscs_contract, cdr.spark_it_zte_acct_extract, cdr.spark_it_zte_bal_extract, mon.spark_ft_client_site_traffic_day, cdr.spark_it_zte_acc_nbr_extract, cdr.spark_it_zte_subs_extract, cdr.spark_it_zte_prod_extract, dim.spark_dt_gsm_cell_code, cdr.spark_it_zte_price_plan_extract, dim.dt_balance_type_item, dim.spark_dt_offer_profiles, mon.spark_ft_contract_snapshot'}, 'scratch_reload_susp': {'Alias/Projection': 'scratch_reload_susp', 'Colonnes détectées': [], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': 'NULL', 'Table(s) utilisées': 'cdr.spark_it_zte_cust_extract, mon.spark_ft_client_last_site_day, mon.ft_bscs_contract, cdr.spark_it_zte_acct_extract, cdr.spark_it_zte_bal_extract, mon.spark_ft_client_site_traffic_day, cdr.spark_it_zte_acc_nbr_extract, cdr.spark_it_zte_subs_extract, cdr.spark_it_zte_prod_extract, dim.spark_dt_gsm_cell_code, cdr.spark_it_zte_price_plan_extract, dim.dt_balance_type_item, dim.spark_dt_offer_profiles, mon.spark_ft_contract_snapshot'}, 'commercial_offer_assign_date': {'Alias/Projection': 'commercial_offer_assign_date', 'Colonnes détectées': ['update_date'], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': 'TO_DATE(`zte`.`update_date`)', 'Table(s) utilisées': 'cdr.spark_it_zte_cust_extract, mon.spark_ft_client_last_site_day, mon.ft_bscs_contract, cdr.spark_it_zte_acct_extract, cdr.spark_it_zte_bal_extract, mon.spark_ft_client_site_traffic_day, cdr.spark_it_zte_acc_nbr_extract, cdr.spark_it_zte_subs_extract, cdr.spark_it_zte_prod_extract, dim.spark_dt_gsm_cell_code, cdr.spark_it_zte_price_plan_extract, dim.dt_balance_type_item, dim.spark_dt_offer_profiles, mon.spark_ft_contract_snapshot'}, 'commercial_offer': {'Alias/Projection': 'commercial_offer', 'Colonnes détectées': ['price_plan_name'], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': '`zte`.`price_plan_name`', 'Table(s) utilisées': 'cdr.spark_it_zte_cust_extract, mon.spark_ft_client_last_site_day, mon.ft_bscs_contract, cdr.spark_it_zte_acct_extract, cdr.spark_it_zte_bal_extract, mon.spark_ft_client_site_traffic_day, cdr.spark_it_zte_acc_nbr_extract, cdr.spark_it_zte_subs_extract, cdr.spark_it_zte_prod_extract, dim.spark_dt_gsm_cell_code, cdr.spark_it_zte_price_plan_extract, dim.dt_balance_type_item, dim.spark_dt_offer_profiles, mon.spark_ft_contract_snapshot'}, 'current_status': {'Alias/Projection': 'current_status', 'Colonnes détectées': ['current_status_1'], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': 
'`spark_ft_contract_snapshot`.`current_status_1`', 'Table(s) utilisées': 'mon.spark_ft_contract_snapshot'}, 'status_date': {'Alias/Projection': 'status_date', 'Colonnes détectées': ['status_date'], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': '`bscs_contract`.`status_date`', 'Table(s) utilisées': 'cdr.spark_it_zte_cust_extract, mon.spark_ft_client_last_site_day, mon.ft_bscs_contract, cdr.spark_it_zte_acct_extract, cdr.spark_it_zte_bal_extract, mon.spark_ft_client_site_traffic_day, cdr.spark_it_zte_acc_nbr_extract, cdr.spark_it_zte_subs_extract, cdr.spark_it_zte_prod_extract, dim.spark_dt_gsm_cell_code, cdr.spark_it_zte_price_plan_extract, dim.dt_balance_type_item, dim.spark_dt_offer_profiles, mon.spark_ft_contract_snapshot'}, 'login': {'Alias/Projection': 'login', 'Colonnes détectées': [], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': 'NULL', 'Table(s) utilisées': 'cdr.spark_it_zte_cust_extract, mon.spark_ft_client_last_site_day, mon.ft_bscs_contract, cdr.spark_it_zte_acct_extract, cdr.spark_it_zte_bal_extract, mon.spark_ft_client_site_traffic_day, cdr.spark_it_zte_acc_nbr_extract, cdr.spark_it_zte_subs_extract, cdr.spark_it_zte_prod_extract, dim.spark_dt_gsm_cell_code, cdr.spark_it_zte_price_plan_extract, dim.dt_balance_type_item, dim.spark_dt_offer_profiles, mon.spark_ft_contract_snapshot'}, 'lang': {'Alias/Projection': 'lang', 'Colonnes détectées': ['def_lang_id'], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': '`zte`.`def_lang_id`', 'Table(s) utilisées': 'cdr.spark_it_zte_cust_extract, mon.spark_ft_client_last_site_day, mon.ft_bscs_contract, cdr.spark_it_zte_acct_extract, cdr.spark_it_zte_bal_extract, mon.spark_ft_client_site_traffic_day, cdr.spark_it_zte_acc_nbr_extract, cdr.spark_it_zte_subs_extract, cdr.spark_it_zte_prod_extract, dim.spark_dt_gsm_cell_code, cdr.spark_it_zte_price_plan_extract, dim.dt_balance_type_item, dim.spark_dt_offer_profiles, mon.spark_ft_contract_snapshot'}, 'location': {'Alias/Projection': 'location', 'Colonnes détectées': [], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': 'NULL', 'Table(s) utilisées': 'cdr.spark_it_zte_cust_extract, mon.spark_ft_client_last_site_day, mon.ft_bscs_contract, cdr.spark_it_zte_acct_extract, cdr.spark_it_zte_bal_extract, mon.spark_ft_client_site_traffic_day, cdr.spark_it_zte_acc_nbr_extract, cdr.spark_it_zte_subs_extract, cdr.spark_it_zte_prod_extract, dim.spark_dt_gsm_cell_code, cdr.spark_it_zte_price_plan_extract, dim.dt_balance_type_item, dim.spark_dt_offer_profiles, mon.spark_ft_contract_snapshot'}, 'main_imsi': {'Alias/Projection': 'main_imsi', 'Colonnes détectées': ['imsi'], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': '`zte`.`imsi`', 'Table(s) utilisées': 'cdr.spark_it_zte_cust_extract, mon.spark_ft_client_last_site_day, mon.ft_bscs_contract, cdr.spark_it_zte_acct_extract, cdr.spark_it_zte_bal_extract, mon.spark_ft_client_site_traffic_day, cdr.spark_it_zte_acc_nbr_extract, cdr.spark_it_zte_subs_extract, cdr.spark_it_zte_prod_extract, dim.spark_dt_gsm_cell_code, cdr.spark_it_zte_price_plan_extract, 
dim.dt_balance_type_item, dim.spark_dt_offer_profiles, mon.spark_ft_contract_snapshot'}, 'msid_type':
 {'Alias/Projection': 'msid_type', 'Colonnes détectées': [], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': 'NULL', 'Table(s) utilisées': 'cdr.spark_it_zte_cust_extract, mon.spark_ft_client_last_site_day, mon.ft_bscs_contract, cdr.spark_it_zte_acct_extract, cdr.spark_it_zte_bal_extract, mon.spark_ft_client_site_traffic_day, cdr.spark_it_zte_acc_nbr_extract, cdr.spark_it_zte_subs_extract, cdr.spark_it_zte_prod_extract, dim.spark_dt_gsm_cell_code, cdr.spark_it_zte_price_plan_extract, dim.dt_balance_type_item, dim.spark_dt_offer_profiles, mon.spark_ft_contract_snapshot'}, 'profile': {'Alias/Projection': 'profile', 'Colonnes détectées': ['price_plan_name'], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': '`zte`.`price_plan_name`', 'Table(s) utilisées': 'cdr.spark_it_zte_cust_extract, mon.spark_ft_client_last_site_day, mon.ft_bscs_contract, cdr.spark_it_zte_acct_extract, cdr.spark_it_zte_bal_extract, mon.spark_ft_client_site_traffic_day, cdr.spark_it_zte_acc_nbr_extract, cdr.spark_it_zte_subs_extract, cdr.spark_it_zte_prod_extract, dim.spark_dt_gsm_cell_code, cdr.spark_it_zte_price_plan_extract, dim.dt_balance_type_item, dim.spark_dt_offer_profiles, mon.spark_ft_contract_snapshot'}, 'bad_reload_attempts': {'Alias/Projection': 'bad_reload_attempts', 'Colonnes détectées': [], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': 'NULL', 'Table(s) utilisées': 'cdr.spark_it_zte_cust_extract, mon.spark_ft_client_last_site_day, mon.ft_bscs_contract, cdr.spark_it_zte_acct_extract, cdr.spark_it_zte_bal_extract, mon.spark_ft_client_site_traffic_day, cdr.spark_it_zte_acc_nbr_extract, cdr.spark_it_zte_subs_extract, cdr.spark_it_zte_prod_extract, dim.spark_dt_gsm_cell_code, cdr.spark_it_zte_price_plan_extract, dim.dt_balance_type_item, dim.spark_dt_offer_profiles, mon.spark_ft_contract_snapshot'}, 'last_topup_date': {'Alias/Projection': 'last_topup_date', 'Colonnes détectées': ['acct_update_date'], 'agg': [], 
'Opérations arithmétiques': [], 'Formule SQL': 'TO_DATE(`zte`.`acct_update_date`)', 'Table(s) utilisées': 'cdr.spark_it_zte_cust_extract, mon.spark_ft_client_last_site_day, mon.ft_bscs_contract, cdr.spark_it_zte_acct_extract, cdr.spark_it_zte_bal_extract, mon.spark_ft_client_site_traffic_day, cdr.spark_it_zte_acc_nbr_extract, cdr.spark_it_zte_subs_extract, cdr.spark_it_zte_prod_extract, dim.spark_dt_gsm_cell_code, cdr.spark_it_zte_price_plan_extract, dim.dt_balance_type_item, dim.spark_dt_offer_profiles, mon.spark_ft_contract_snapshot'}, 'last_credit_update_date': {'Alias/Projection': 'last_credit_update_date', 'Colonnes détectées': ['acct_update_date'], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': 'TO_DATE(`zte`.`acct_update_date`)', 'Table(s) utilisées': 'cdr.spark_it_zte_cust_extract, mon.spark_ft_client_last_site_day, mon.ft_bscs_contract, cdr.spark_it_zte_acct_extract, cdr.spark_it_zte_bal_extract, mon.spark_ft_client_site_traffic_day, cdr.spark_it_zte_acc_nbr_extract, cdr.spark_it_zte_subs_extract, cdr.spark_it_zte_prod_extract, dim.spark_dt_gsm_cell_code, cdr.spark_it_zte_price_plan_extract, dim.dt_balance_type_item, dim.spark_dt_offer_profiles, mon.spark_ft_contract_snapshot'}, 'bad_pin_attempts': {'Alias/Projection': 'bad_pin_attempts', 'Colonnes détectées': [], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': 'NULL', 'Table(s) utilisées': 'cdr.spark_it_zte_cust_extract, mon.spark_ft_client_last_site_day, mon.ft_bscs_contract, cdr.spark_it_zte_acct_extract, cdr.spark_it_zte_bal_extract, mon.spark_ft_client_site_traffic_day, cdr.spark_it_zte_acc_nbr_extract, cdr.spark_it_zte_subs_extract, cdr.spark_it_zte_prod_extract, dim.spark_dt_gsm_cell_code, cdr.spark_it_zte_price_plan_extract, dim.dt_balance_type_item, dim.spark_dt_offer_profiles, mon.spark_ft_contract_snapshot'}, 'bad_pwd_attempts': {'Alias/Projection': 'bad_pwd_attempts', 'Colonnes détectées': [], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': 'NULL', 'Table(s) utilisées': 'cdr.spark_it_zte_cust_extract, mon.spark_ft_client_last_site_day, mon.ft_bscs_contract, cdr.spark_it_zte_acct_extract, cdr.spark_it_zte_bal_extract, mon.spark_ft_client_site_traffic_day, cdr.spark_it_zte_acc_nbr_extract, cdr.spark_it_zte_subs_extract, cdr.spark_it_zte_prod_extract, dim.spark_dt_gsm_cell_code, cdr.spark_it_zte_price_plan_extract, dim.dt_balance_type_item, dim.spark_dt_offer_profiles, mon.spark_ft_contract_snapshot'}, 'osp_account_type': {'Alias/Projection': 'osp_account_type', 'Colonnes détectées': ['subscriber_type', 'subscriber_type', 'subscriber_type'], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': "(CASE WHEN UPPER(`zte`.`subscriber_type`) LIKE '%POSTPAID%' THEN 'POSTPAID' WHEN UPPER(`zte`.`subscriber_type`) LIKE '%PREPAID%' OR UPPER(`zte`.`subscriber_type`) LIKE '%HYBRID%' THEN 'PREPAID' ELSE NULL END)", 'Table(s) utilisées': 'cdr.spark_it_zte_cust_extract, mon.spark_ft_client_last_site_day, mon.ft_bscs_contract, cdr.spark_it_zte_acct_extract, cdr.spark_it_zte_bal_extract, mon.spark_ft_client_site_traffic_day, cdr.spark_it_zte_acc_nbr_extract, cdr.spark_it_zte_subs_extract, cdr.spark_it_zte_prod_extract, dim.spark_dt_gsm_cell_code, cdr.spark_it_zte_price_plan_extract, dim.dt_balance_type_item, dim.spark_dt_offer_profiles, mon.spark_ft_contract_snapshot'}, 'inactivity_credit_loss': {'Alias/Projection': 'inactivity_credit_loss', 'Colonnes détectées': [], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': 'NULL', 'Table(s) utilisées': 'cdr.spark_it_zte_cust_extract, mon.spark_ft_client_last_site_day, mon.ft_bscs_contract, cdr.spark_it_zte_acct_extract, cdr.spark_it_zte_bal_extract, mon.spark_ft_client_site_traffic_day, cdr.spark_it_zte_acc_nbr_extract, cdr.spark_it_zte_subs_extract, cdr.spark_it_zte_prod_extract, dim.spark_dt_gsm_cell_code, cdr.spark_it_zte_price_plan_extract, dim.dt_balance_type_item, dim.spark_dt_offer_profiles, mon.spark_ft_contract_snapshot'}, 'dealer_id': {'Alias/Projection': 'dealer_id', 'Colonnes détectées': [], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': 'NULL', 'Table(s) utilisées': 'cdr.spark_it_zte_cust_extract, mon.spark_ft_client_last_site_day, mon.ft_bscs_contract, cdr.spark_it_zte_acct_extract, cdr.spark_it_zte_bal_extract, mon.spark_ft_client_site_traffic_day, cdr.spark_it_zte_acc_nbr_extract, cdr.spark_it_zte_subs_extract, cdr.spark_it_zte_prod_extract, dim.spark_dt_gsm_cell_code, cdr.spark_it_zte_price_plan_extract, dim.dt_balance_type_item, dim.spark_dt_offer_profiles, mon.spark_ft_contract_snapshot'}, 'provisioning_date': {'Alias/Projection': 'provisioning_date', 'Colonnes détectées': ['acct_created_date'], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': 'TO_DATE(`zte`.`acct_created_date`)', 'Table(s) utilisées': 'cdr.spark_it_zte_cust_extract, mon.spark_ft_client_last_site_day, mon.ft_bscs_contract, cdr.spark_it_zte_acct_extract, cdr.spark_it_zte_bal_extract, mon.spark_ft_client_site_traffic_day, cdr.spark_it_zte_acc_nbr_extract, cdr.spark_it_zte_subs_extract, cdr.spark_it_zte_prod_extract, dim.spark_dt_gsm_cell_code, cdr.spark_it_zte_price_plan_extract, dim.dt_balance_type_item, dim.spark_dt_offer_profiles, mon.spark_ft_contract_snapshot'}, 'main_credit': {'Alias/Projection': 'main_credit', 'Colonnes détectées': ['reserve_main_balance', 'gross_main_balance', 'consume_main_balance'], 'agg': [], 'Opérations arithmétiques': ['+'], 'Formule SQL': '(`zte`.`gross_main_balance` + `zte`.`consume_main_balance` + 
`zte`.`reserve_main_balance`)', 'Table(s) utilisées': 'cdr.spark_it_zte_cust_extract, mon.spark_ft_client_last_site_day, mon.ft_bscs_contract, cdr.spark_it_zte_acct_extract, cdr.spark_it_zte_bal_extract, mon.spark_ft_client_site_traffic_day, cdr.spark_it_zte_acc_nbr_extract, cdr.spark_it_zte_subs_extract, cdr.spark_it_zte_prod_extract, dim.spark_dt_gsm_cell_code, cdr.spark_it_zte_price_plan_extract, dim.dt_balance_type_item, dim.spark_dt_offer_profiles, mon.spark_ft_contract_snapshot'}, 'promo_credit': {'Alias/Projection': 'promo_credit', 'Colonnes détectées': ['reserve_promo_balance', 'gross_promo_balance', 'consume_promo_balance'], 'agg': [], 'Opérations arithmétiques': ['+'], 'Formule SQL': '(`zte`.`gross_promo_balance` + `zte`.`consume_promo_balance` + `zte`.`reserve_promo_balance`)', 'Table(s) utilisées': 'cdr.spark_it_zte_cust_extract, mon.spark_ft_client_last_site_day, mon.ft_bscs_contract, cdr.spark_it_zte_acct_extract, cdr.spark_it_zte_bal_extract, mon.spark_ft_client_site_traffic_day, cdr.spark_it_zte_acc_nbr_extract, cdr.spark_it_zte_subs_extract, cdr.spark_it_zte_prod_extract, dim.spark_dt_gsm_cell_code, cdr.spark_it_zte_price_plan_extract, dim.dt_balance_type_item, 
dim.spark_dt_offer_profiles, mon.spark_ft_contract_snapshot'}, 'sms_credit': {'Alias/Projection': 'sms_credit', 'Colonnes détectées': [], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': 'NULL', 'Table(s) utilisées': 'cdr.spark_it_zte_cust_extract, mon.spark_ft_client_last_site_day, mon.ft_bscs_contract, cdr.spark_it_zte_acct_extract, cdr.spark_it_zte_bal_extract, mon.spark_ft_client_site_traffic_day, cdr.spark_it_zte_acc_nbr_extract, cdr.spark_it_zte_subs_extract, cdr.spark_it_zte_prod_extract, dim.spark_dt_gsm_cell_code, cdr.spark_it_zte_price_plan_extract, dim.dt_balance_type_item, dim.spark_dt_offer_profiles, mon.spark_ft_contract_snapshot'}, 'data_credit': {'Alias/Projection': 'data_credit', 'Colonnes détectées': [], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': 'NULL', 'Table(s) utilisées': 'cdr.spark_it_zte_cust_extract, mon.spark_ft_client_last_site_day, mon.ft_bscs_contract, cdr.spark_it_zte_acct_extract, cdr.spark_it_zte_bal_extract, mon.spark_ft_client_site_traffic_day, cdr.spark_it_zte_acc_nbr_extract, cdr.spark_it_zte_subs_extract, cdr.spark_it_zte_prod_extract, dim.spark_dt_gsm_cell_code, cdr.spark_it_zte_price_plan_extract, dim.dt_balance_type_item, dim.spark_dt_offer_profiles, mon.spark_ft_contract_snapshot'}, 'used_credit_month': {'Alias/Projection': 'used_credit_month', 'Colonnes détectées': [], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': 'NULL', 'Table(s) utilisées': 'cdr.spark_it_zte_cust_extract, mon.spark_ft_client_last_site_day, mon.ft_bscs_contract, cdr.spark_it_zte_acct_extract, cdr.spark_it_zte_bal_extract, mon.spark_ft_client_site_traffic_day, cdr.spark_it_zte_acc_nbr_extract, cdr.spark_it_zte_subs_extract, cdr.spark_it_zte_prod_extract, dim.spark_dt_gsm_cell_code, cdr.spark_it_zte_price_plan_extract, dim.dt_balance_type_item, dim.spark_dt_offer_profiles, mon.spark_ft_contract_snapshot'}, 'used_credit_life': {'Alias/Projection': 'used_credit_life', 'Colonnes détectées': [], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': 'NULL', 'Table(s) utilisées': 'cdr.spark_it_zte_cust_extract, mon.spark_ft_client_last_site_day, mon.ft_bscs_contract, cdr.spark_it_zte_acct_extract, cdr.spark_it_zte_bal_extract, mon.spark_ft_client_site_traffic_day, cdr.spark_it_zte_acc_nbr_extract, cdr.spark_it_zte_subs_extract, cdr.spark_it_zte_prod_extract, dim.spark_dt_gsm_cell_code, cdr.spark_it_zte_price_plan_extract, dim.dt_balance_type_item, dim.spark_dt_offer_profiles, mon.spark_ft_contract_snapshot'}, 'bundle_list': {'Alias/Projection': 'bundle_list', 'Colonnes détectées': ['bundle_list'], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': '`bscs_contract`.`bundle_list`', 'Table(s) utilisées': 'cdr.spark_it_zte_cust_extract, mon.spark_ft_client_last_site_day, mon.ft_bscs_contract, cdr.spark_it_zte_acct_extract, cdr.spark_it_zte_bal_extract, mon.spark_ft_client_site_traffic_day, cdr.spark_it_zte_acc_nbr_extract, cdr.spark_it_zte_subs_extract, cdr.spark_it_zte_prod_extract, dim.spark_dt_gsm_cell_code, cdr.spark_it_zte_price_plan_extract, dim.dt_balance_type_item, dim.spark_dt_offer_profiles, mon.spark_ft_contract_snapshot'}, 'bundle_unit_list': {'Alias/Projection': 'bundle_unit_list', 'Colonnes détectées': ['bundle_unit_list'], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': '`bscs_contract`.`bundle_unit_list`', 'Table(s) utilisées': 'cdr.spark_it_zte_cust_extract, mon.spark_ft_client_last_site_day, mon.ft_bscs_contract, cdr.spark_it_zte_acct_extract, cdr.spark_it_zte_bal_extract, mon.spark_ft_client_site_traffic_day, cdr.spark_it_zte_acc_nbr_extract, cdr.spark_it_zte_subs_extract, cdr.spark_it_zte_prod_extract, dim.spark_dt_gsm_cell_code, cdr.spark_it_zte_price_plan_extract, dim.dt_balance_type_item, dim.spark_dt_offer_profiles, mon.spark_ft_contract_snapshot'}, 'promo_and_discount_list': {'Alias/Projection': 'promo_and_discount_list', 'Colonnes détectées': ['promo_and_discount_list'], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': '`bscs_contract`.`promo_and_discount_list`', 'Table(s) utilisées': 'cdr.spark_it_zte_cust_extract, mon.spark_ft_client_last_site_day, mon.ft_bscs_contract, cdr.spark_it_zte_acct_extract, cdr.spark_it_zte_bal_extract, mon.spark_ft_client_site_traffic_day, cdr.spark_it_zte_acc_nbr_extract, cdr.spark_it_zte_subs_extract, cdr.spark_it_zte_prod_extract, dim.spark_dt_gsm_cell_code, cdr.spark_it_zte_price_plan_extract, dim.dt_balance_type_item, dim.spark_dt_offer_profiles, mon.spark_ft_contract_snapshot'}, 'insert_date': {'Alias/Projection': 'insert_date', 'Colonnes détectées': [], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': 'CURRENT_TIMESTAMP()', 'Table(s) utilisées': 'cdr.spark_it_zte_cust_extract, mon.spark_ft_client_last_site_day, mon.ft_bscs_contract, cdr.spark_it_zte_acct_extract, cdr.spark_it_zte_bal_extract, mon.spark_ft_client_site_traffic_day, cdr.spark_it_zte_acc_nbr_extract, cdr.spark_it_zte_subs_extract, cdr.spark_it_zte_prod_extract, dim.spark_dt_gsm_cell_code, cdr.spark_it_zte_price_plan_extract, dim.dt_balance_type_item, dim.spark_dt_offer_profiles, mon.spark_ft_contract_snapshot'}, 'src_table': {'Alias/Projection': 'src_table', 'Colonnes détectées': ['price_plan_name', 'price_plan_name'], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': "(CASE WHEN UPPER(`zte`.`price_plan_name`) LIKE 'POSTPAID%' THEN 'FT_BSCS_CONTRACT' WHEN UPPER(`zte`.`price_plan_name`) LIKE 'PREPAID%' THEN 'IT_ICC_ACCOUNT' ELSE 'IT_ICC_ACCOUNT' END)", 'Table(s) utilisées': 'cdr.spark_it_zte_cust_extract, mon.spark_ft_client_last_site_day, mon.ft_bscs_contract, cdr.spark_it_zte_acct_extract, cdr.spark_it_zte_bal_extract, mon.spark_ft_client_site_traffic_day, cdr.spark_it_zte_acc_nbr_extract, cdr.spark_it_zte_subs_extract, cdr.spark_it_zte_prod_extract, dim.spark_dt_gsm_cell_code, cdr.spark_it_zte_price_plan_extract, dim.dt_balance_type_item, dim.spark_dt_offer_profiles, mon.spark_ft_contract_snapshot'}, 'osp_status': {'Alias/Projection': 'osp_status', 'Colonnes détectées': ['prod_prod_state', 'prod_prod_state', 'block_reason'], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': "(CASE WHEN (`zte`.`prod_prod_state` = 'DEACTIVATED' 
AND `zte`.`block_reason` = '20000000000000') THEN 'INACTIVE' ELSE `zte`.`prod_prod_state` END)", 'Table(s) utilisées': 'cdr.spark_it_zte_cust_extract, mon.spark_ft_client_last_site_day, mon.ft_bscs_contract, cdr.spark_it_zte_acct_extract, cdr.spark_it_zte_bal_extract, mon.spark_ft_client_site_traffic_day, cdr.spark_it_zte_acc_nbr_extract, cdr.spark_it_zte_subs_extract, cdr.spark_it_zte_prod_extract, dim.spark_dt_gsm_cell_code, cdr.spark_it_zte_price_plan_extract, dim.dt_balance_type_item, dim.spark_dt_offer_profiles, mon.spark_ft_contract_snapshot'}, 'bscs_comm_offer_id': {'Alias/Projection': 'bscs_comm_offer_id', 'Colonnes détectées': ['commercial_offer'], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': '`bscs_contract`.`commercial_offer`', 'Table(s) utilisées': 'cdr.spark_it_zte_cust_extract, mon.spark_ft_client_last_site_day, mon.ft_bscs_contract, cdr.spark_it_zte_acct_extract, cdr.spark_it_zte_bal_extract, mon.spark_ft_client_site_traffic_day, cdr.spark_it_zte_acc_nbr_extract, cdr.spark_it_zte_subs_extract, cdr.spark_it_zte_prod_extract, dim.spark_dt_gsm_cell_code, cdr.spark_it_zte_price_plan_extract, dim.dt_balance_type_item, dim.spark_dt_offer_profiles, mon.spark_ft_contract_snapshot'}, 'bscs_comm_offer': {'Alias/Projection': 'bscs_comm_offer', 'Colonnes détectées': ['scommercial_offer'], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': '`bscs_contract`.`scommercial_offer`', 'Table(s) utilisées': 'cdr.spark_it_zte_cust_extract, mon.spark_ft_client_last_site_day, mon.ft_bscs_contract, cdr.spark_it_zte_acct_extract, cdr.spark_it_zte_bal_extract, mon.spark_ft_client_site_traffic_day, cdr.spark_it_zte_acc_nbr_extract, cdr.spark_it_zte_subs_extract, cdr.spark_it_zte_prod_extract, dim.spark_dt_gsm_cell_code, cdr.spark_it_zte_price_plan_extract, dim.dt_balance_type_item, dim.spark_dt_offer_profiles, mon.spark_ft_contract_snapshot'}, 'initial_selection_done': {'Alias/Projection': 'initial_selection_done', 'Colonnes détectées': [], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': 'NULL', 'Table(s) utilisées': 'cdr.spark_it_zte_cust_extract, mon.spark_ft_client_last_site_day, mon.ft_bscs_contract, cdr.spark_it_zte_acct_extract, cdr.spark_it_zte_bal_extract, mon.spark_ft_client_site_traffic_day, cdr.spark_it_zte_acc_nbr_extract, cdr.spark_it_zte_subs_extract, cdr.spark_it_zte_prod_extract, dim.spark_dt_gsm_cell_code, cdr.spark_it_zte_price_plan_extract, dim.dt_balance_type_item, dim.spark_dt_offer_profiles, mon.spark_ft_contract_snapshot'}, 'nomore_credit': {'Alias/Projection': 'nomore_credit', 'Colonnes détectées': [], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': 'NULL', 'Table(s) utilisées': 'cdr.spark_it_zte_cust_extract, mon.spark_ft_client_last_site_day, mon.ft_bscs_contract, cdr.spark_it_zte_acct_extract, cdr.spark_it_zte_bal_extract, mon.spark_ft_client_site_traffic_day, cdr.spark_it_zte_acc_nbr_extract, cdr.spark_it_zte_subs_extract, cdr.spark_it_zte_prod_extract, dim.spark_dt_gsm_cell_code, cdr.spark_it_zte_price_plan_extract, dim.dt_balance_type_item, dim.spark_dt_offer_profiles, mon.spark_ft_contract_snapshot'}, 'pwd_blocked': {'Alias/Projection': 'pwd_blocked', 'Colonnes détectées': [], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': 'NULL', 'Table(s) utilisées': 'cdr.spark_it_zte_cust_extract, mon.spark_ft_client_last_site_day, mon.ft_bscs_contract, cdr.spark_it_zte_acct_extract, cdr.spark_it_zte_bal_extract, mon.spark_ft_client_site_traffic_day, cdr.spark_it_zte_acc_nbr_extract, cdr.spark_it_zte_subs_extract, cdr.spark_it_zte_prod_extract, dim.spark_dt_gsm_cell_code, cdr.spark_it_zte_price_plan_extract, dim.dt_balance_type_item, dim.spark_dt_offer_profiles, mon.spark_ft_contract_snapshot'}, 'first_event_done': {'Alias/Projection': 'first_event_done', 'Colonnes détectées': [], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': 'NULL', 'Table(s) utilisées': 'cdr.spark_it_zte_cust_extract, mon.spark_ft_client_last_site_day, mon.ft_bscs_contract, cdr.spark_it_zte_acct_extract, cdr.spark_it_zte_bal_extract, mon.spark_ft_client_site_traffic_day, cdr.spark_it_zte_acc_nbr_extract, cdr.spark_it_zte_subs_extract, cdr.spark_it_zte_prod_extract, dim.spark_dt_gsm_cell_code, cdr.spark_it_zte_price_plan_extract, dim.dt_balance_type_item, dim.spark_dt_offer_profiles, mon.spark_ft_contract_snapshot'}, 'cust_ext_id': {'Alias/Projection': 'cust_ext_id', 'Colonnes détectées': [], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': 'NULL', 'Table(s) utilisées': 'cdr.spark_it_zte_cust_extract, mon.spark_ft_client_last_site_day, mon.ft_bscs_contract, cdr.spark_it_zte_acct_extract, cdr.spark_it_zte_bal_extract, mon.spark_ft_client_site_traffic_day, cdr.spark_it_zte_acc_nbr_extract, cdr.spark_it_zte_subs_extract, cdr.spark_it_zte_prod_extract, dim.spark_dt_gsm_cell_code, cdr.spark_it_zte_price_plan_extract, dim.dt_balance_type_item, dim.spark_dt_offer_profiles, mon.spark_ft_contract_snapshot'}, 'cust_group': {'Alias/Projection': 'cust_group', 'Colonnes détectées': [], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': 'NULL', 'Table(s) utilisées': 'cdr.spark_it_zte_cust_extract, mon.spark_ft_client_last_site_day, mon.ft_bscs_contract, cdr.spark_it_zte_acct_extract, cdr.spark_it_zte_bal_extract, mon.spark_ft_client_site_traffic_day, cdr.spark_it_zte_acc_nbr_extract, cdr.spark_it_zte_subs_extract, cdr.spark_it_zte_prod_extract, dim.spark_dt_gsm_cell_code, cdr.spark_it_zte_price_plan_extract, dim.dt_balance_type_item, 
dim.spark_dt_offer_profiles, mon.spark_ft_contract_snapshot'}, 'cust_category': {'Alias/Projection': 'cust_category', 'Colonnes détectées': [], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': 'NULL', 'Table(s) utilisées': 'cdr.spark_it_zte_cust_extract, mon.spark_ft_client_last_site_day, mon.ft_bscs_contract, cdr.spark_it_zte_acct_extract, cdr.spark_it_zte_bal_extract, mon.spark_ft_client_site_traffic_day, cdr.spark_it_zte_acc_nbr_extract, cdr.spark_it_zte_subs_extract, cdr.spark_it_zte_prod_extract, dim.spark_dt_gsm_cell_code, cdr.spark_it_zte_price_plan_extract, dim.dt_balance_type_item, dim.spark_dt_offer_profiles, mon.spark_ft_contract_snapshot'}, 'cust_billcycle': {'Alias/Projection': 'cust_billcycle', 'Colonnes détectées': [], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': 'NULL', 'Table(s) utilisées': 'cdr.spark_it_zte_cust_extract, mon.spark_ft_client_last_site_day, mon.ft_bscs_contract, cdr.spark_it_zte_acct_extract, cdr.spark_it_zte_bal_extract, mon.spark_ft_client_site_traffic_day, cdr.spark_it_zte_acc_nbr_extract, cdr.spark_it_zte_subs_extract, cdr.spark_it_zte_prod_extract, dim.spark_dt_gsm_cell_code, cdr.spark_it_zte_price_plan_extract, dim.dt_balance_type_item, dim.spark_dt_offer_profiles, mon.spark_ft_contract_snapshot'}, 'cust_segment': {'Alias/Projection': 'cust_segment', 'Colonnes détectées': [], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': 'NULL', 'Table(s) utilisées': 'cdr.spark_it_zte_cust_extract, mon.spark_ft_client_last_site_day, mon.ft_bscs_contract, cdr.spark_it_zte_acct_extract, cdr.spark_it_zte_bal_extract, mon.spark_ft_client_site_traffic_day, cdr.spark_it_zte_acc_nbr_extract, cdr.spark_it_zte_subs_extract, cdr.spark_it_zte_prod_extract, dim.spark_dt_gsm_cell_code, cdr.spark_it_zte_price_plan_extract, dim.dt_balance_type_item, dim.spark_dt_offer_profiles, mon.spark_ft_contract_snapshot'}, 'osp_contract_type': {'Alias/Projection': 'osp_contract_type', 'Colonnes détectées': ['subscriber_type', 'subscriber_type', 'subscriber_type'], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': "(CASE WHEN UPPER(`zte`.`subscriber_type`) LIKE '%POSTPAID%' THEN 'PURE POSTPAID' WHEN UPPER(`zte`.`subscriber_type`) LIKE '%PREPAID%' THEN 'PURE PREPAID' WHEN UPPER(`zte`.`subscriber_type`) LIKE '%HYBRID%' THEN 'HYBRID' ELSE NULL END)", 'Table(s) utilisées': 'cdr.spark_it_zte_cust_extract, mon.spark_ft_client_last_site_day, mon.ft_bscs_contract, cdr.spark_it_zte_acct_extract, cdr.spark_it_zte_bal_extract, mon.spark_ft_client_site_traffic_day, cdr.spark_it_zte_acc_nbr_extract, cdr.spark_it_zte_subs_extract, cdr.spark_it_zte_prod_extract, dim.spark_dt_gsm_cell_code, cdr.spark_it_zte_price_plan_extract, dim.dt_balance_type_item, dim.spark_dt_offer_profiles, mon.spark_ft_contract_snapshot'}, 'osp_cust_commercial_offer': {'Alias/Projection': 'osp_cust_commercial_offer', 'Colonnes détectées': [], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': 'NULL', 'Table(s) utilisées': 'cdr.spark_it_zte_cust_extract, mon.spark_ft_client_last_site_day, mon.ft_bscs_contract, cdr.spark_it_zte_acct_extract, cdr.spark_it_zte_bal_extract, mon.spark_ft_client_site_traffic_day, cdr.spark_it_zte_acc_nbr_extract, cdr.spark_it_zte_subs_extract, cdr.spark_it_zte_prod_extract, dim.spark_dt_gsm_cell_code, cdr.spark_it_zte_price_plan_extract, dim.dt_balance_type_item, dim.spark_dt_offer_profiles, mon.spark_ft_contract_snapshot'}, 'osp_customer_cglist': {'Alias/Projection': 'osp_customer_cglist', 'Colonnes détectées': [], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': 'NULL', 'Table(s) utilisées': 'cdr.spark_it_zte_cust_extract, mon.spark_ft_client_last_site_day, mon.ft_bscs_contract, cdr.spark_it_zte_acct_extract, cdr.spark_it_zte_bal_extract, mon.spark_ft_client_site_traffic_day, cdr.spark_it_zte_acc_nbr_extract, cdr.spark_it_zte_subs_extract, cdr.spark_it_zte_prod_extract, dim.spark_dt_gsm_cell_code, cdr.spark_it_zte_price_plan_extract, dim.dt_balance_type_item, dim.spark_dt_offer_profiles, mon.spark_ft_contract_snapshot'}, 'osp_customer_formule': {'Alias/Projection': 'osp_customer_formule', 'Colonnes détectées': [], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': 'NULL', 'Table(s) utilisées': 'cdr.spark_it_zte_cust_extract, mon.spark_ft_client_last_site_day, mon.ft_bscs_contract, cdr.spark_it_zte_acct_extract, cdr.spark_it_zte_bal_extract, mon.spark_ft_client_site_traffic_day, cdr.spark_it_zte_acc_nbr_extract, cdr.spark_it_zte_subs_extract, cdr.spark_it_zte_prod_extract, dim.spark_dt_gsm_cell_code, cdr.spark_it_zte_price_plan_extract, dim.dt_balance_type_item, dim.spark_dt_offer_profiles, mon.spark_ft_contract_snapshot'}, 'bscs_activation_date': {'Alias/Projection': 'bscs_activation_date', 'Colonnes détectées': ['activation_date'], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': '`bscs_contract`.`activation_date`', 'Table(s) utilisées': 'cdr.spark_it_zte_cust_extract, mon.spark_ft_client_last_site_day, mon.ft_bscs_contract, cdr.spark_it_zte_acct_extract, cdr.spark_it_zte_bal_extract, mon.spark_ft_client_site_traffic_day, cdr.spark_it_zte_acc_nbr_extract, cdr.spark_it_zte_subs_extract, cdr.spark_it_zte_prod_extract, dim.spark_dt_gsm_cell_code, cdr.spark_it_zte_price_plan_extract, dim.dt_balance_type_item, dim.spark_dt_offer_profiles, mon.spark_ft_contract_snapshot'}, 'bscs_deactivation_date': {'Alias/Projection': 'bscs_deactivation_date', 'Colonnes détectées': ['deactivation_date'], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': '`bscs_contract`.`deactivation_date`', 'Table(s) utilisées': 'cdr.spark_it_zte_cust_extract, mon.spark_ft_client_last_site_day, mon.ft_bscs_contract, cdr.spark_it_zte_acct_extract, cdr.spark_it_zte_bal_extract, mon.spark_ft_client_site_traffic_day, cdr.spark_it_zte_acc_nbr_extract, cdr.spark_it_zte_subs_extract, cdr.spark_it_zte_prod_extract, dim.spark_dt_gsm_cell_code, cdr.spark_it_zte_price_plan_extract, dim.dt_balance_type_item, dim.spark_dt_offer_profiles, mon.spark_ft_contract_snapshot'}, 'operator_code': {'Alias/Projection': 'operator_code', 'Colonnes détectées': ['sp_id', 'sp_id'], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': "(CASE WHEN `prod`.`sp_id` = '0' THEN 'OCM' WHEN `prod`.`sp_id` = '1' THEN 'SET' ELSE 'UNKNOWN' END)", 'Table(s) utilisées': 'cdr.spark_it_zte_cust_extract, cdr.spark_it_zte_acct_extract, cdr.spark_it_zte_bal_extract, cdr.spark_it_zte_acc_nbr_extract, cdr.spark_it_zte_subs_extract, cdr.spark_it_zte_prod_extract, cdr.spark_it_zte_price_plan_extract, dim.dt_balance_type_item'}, 'balance_list': {'Alias/Projection': 'balance_list', 'Colonnes détectées': ['acct_res_id', 'eff_date', 'update_date', 'exp_date', 'gross_bal', 'consume_bal', 'reserve_bal'], 'agg': ['ARRAYAGG'], 'Opérations arithmétiques': [], 'Formule SQL': "CONCAT_WS('|', COLLECT_LIST(CONCAT_WS('\\\\;', CAST(`bal`.`acct_res_id` AS STRING), CAST(`bal`.`eff_date` AS STRING), CAST(`bal`.`update_date` AS STRING), CAST(`bal`.`exp_date` AS STRING), CAST(CAST(-COALESCE(`bal`.`gross_bal`, 0) AS BIGINT) AS STRING), CAST(CAST(-COALESCE(`bal`.`consume_bal`, 0) AS BIGINT) AS STRING), CAST(CAST(-COALESCE(`bal`.`reserve_bal`, 0) AS BIGINT) AS STRING))))", 'Table(s) utilisées': 'dim.dt_balance_type_item, cdr.spark_it_zte_bal_extract'}, 'previous_status': {'Alias/Projection': 'previous_status', 'Colonnes détectées': ['previous_status'], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': '`spark_ft_contract_snapshot`.`previous_status`', 'Table(s) utilisées': 'mon.spark_ft_contract_snapshot'}, 'current_status_1': {'Alias/Projection': 'current_status_1', 'Colonnes détectées': ['current_status'], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': '`zte`.`current_status`', 'Table(s) utilisées': 'cdr.spark_it_zte_cust_extract, mon.spark_ft_client_last_site_day, mon.ft_bscs_contract, cdr.spark_it_zte_acct_extract, cdr.spark_it_zte_bal_extract, mon.spark_ft_client_site_traffic_day, cdr.spark_it_zte_acc_nbr_extract, cdr.spark_it_zte_subs_extract, cdr.spark_it_zte_prod_extract, dim.spark_dt_gsm_cell_code, cdr.spark_it_zte_price_plan_extract, dim.dt_balance_type_item, dim.spark_dt_offer_profiles, mon.spark_ft_contract_snapshot'}, 'state_datetime': {'Alias/Projection': 'state_datetime', 'Colonnes détectées': ['state_datetime'], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': '`spark_ft_contract_snapshot`.`state_datetime`', 'Table(s) utilisées': 'mon.spark_ft_contract_snapshot'}, 'location_ci': {'Alias/Projection': 'location_ci', 'Colonnes détectées': ['ci'], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': 'LPAD(`cell`.`ci`, 5, 0)', 'Table(s) utilisées': 'cdr.spark_it_zte_cust_extract, mon.spark_ft_client_last_site_day, mon.ft_bscs_contract, cdr.spark_it_zte_acct_extract, cdr.spark_it_zte_bal_extract, mon.spark_ft_client_site_traffic_day, cdr.spark_it_zte_acc_nbr_extract, cdr.spark_it_zte_subs_extract, cdr.spark_it_zte_prod_extract, dim.spark_dt_gsm_cell_code, cdr.spark_it_zte_price_plan_extract, dim.dt_balance_type_item, dim.spark_dt_offer_profiles, mon.spark_ft_contract_snapshot'}, 'event_date': {'Alias/Projection': 'event_date', 'Colonnes détectées': [], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': "TO_DATE(FROM_UNIXTIME(UNIX_TIMESTAMP('###SLICE_VALUE###', 'yyyy-MM-dd')))", 'Table(s) utilisées': 'cdr.spark_it_zte_cust_extract, cdr.spark_it_zte_acct_extract, cdr.spark_it_zte_bal_extract, cdr.spark_it_zte_acc_nbr_extract, cdr.spark_it_zte_subs_extract, cdr.spark_it_zte_prod_extract, cdr.spark_it_zte_price_plan_extract, dim.dt_balance_type_item'}, 'acc_nbr': {'Alias/Projection': 'acc_nbr', 'Colonnes détectées': ['acc_nbr'], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': '`spark_it_zte_acc_nbr_extract`.`acc_nbr`', 'Table(s) utilisées': 'cdr.spark_it_zte_acc_nbr_extract'}, 'acc_nbr_state': {'Alias/Projection': 'acc_nbr_state', 'Colonnes détectées': ['acc_nbr_state'], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': '`spark_it_zte_acc_nbr_extract`.`acc_nbr_state`', 'Table(s) utilisées': 'cdr.spark_it_zte_acc_nbr_extract'}, 'state_date': {'Alias/Projection': 'state_date', 'Colonnes détectées': ['state_date'], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': '`spark_it_zte_prod_extract`.`state_date`', 'Table(s) utilisées': 'cdr.spark_it_zte_prod_extract'}, 'acc_nbr_type_id': {'Alias/Projection': 'acc_nbr_type_id', 'Colonnes détectées': ['acc_nbr_type_id'], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': '`spark_it_zte_acc_nbr_extract`.`acc_nbr_type_id`', 'Table(s) utilisées': 'cdr.spark_it_zte_acc_nbr_extract'}, 'imsi': {'Alias/Projection': 'imsi', 'Colonnes détectées': ['imsi'], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': '`spark_it_zte_subs_extract`.`imsi`', 'Table(s) utilisées': 'cdr.spark_it_zte_subs_extract'}, 'update_date': {'Alias/Projection': 'update_date', 'Colonnes détectées': ['update_date'], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': '`spark_it_zte_acct_extract`.`update_date`', 'Table(s) utilisées': 'cdr.spark_it_zte_acct_extract'}, 'subs_cust_id': {'Alias/Projection': 'subs_cust_id', 'Colonnes détectées': ['cust_id'], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': '`spark_it_zte_subs_extract`.`cust_id`', 'Table(s) utilisées': 'cdr.spark_it_zte_subs_extract'}, 'acct_id': {'Alias/Projection': 'acct_id', 'Colonnes détectées': ['acct_id'], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': '`bal`.`acct_id`', 'Table(s) utilisées': 'dim.dt_balance_type_item, cdr.spark_it_zte_bal_extract'}, 'price_plan_id': {'Alias/Projection': 'price_plan_id', 'Colonnes détectées': ['price_plan_id'], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': '`spark_it_zte_price_plan_extract`.`price_plan_id`', 'Table(s) utilisées': 'cdr.spark_it_zte_price_plan_extract'}, 'subscriber_type': {'Alias/Projection': 'subscriber_type', 'Colonnes détectées': ['subscriber_type'], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': '`spark_it_zte_subs_extract`.`subscriber_type`', 'Table(s) utilisées': 'cdr.spark_it_zte_subs_extract'}, 'def_lang_id': {'Alias/Projection': 'def_lang_id', 'Colonnes détectées': ['def_lang_id'], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': '`spark_it_zte_subs_extract`.`def_lang_id`', 'Table(s) utilisées': 'cdr.spark_it_zte_subs_extract'}, 'cust_id': {'Alias/Projection': 'cust_id', 'Colonnes d��tectées': ['cust_id'], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': '`spark_it_zte_cust_extract`.`cust_id`', 'Table(s) utilisées': 'cdr.spark_it_zte_cust_extract'}, 'cust_name': {'Alias/Projection': 'cust_name', 'Colonnes détectées': ['cust_name'], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': '`spark_it_zte_cust_extract`.`cust_name`', 'Table(s) utilisées': 'cdr.spark_it_zte_cust_extract'}, 'address': {'Alias/Projection': 'address', 'Colonnes détectées': ['address'], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': '`spark_it_zte_cust_extract`.`address`', 'Table(s) utilisées': 'cdr.spark_it_zte_cust_extract'}, 'cust_type': {'Alias/Projection': 'cust_type', 'Colonnes détectées': ['cust_type'], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': '`spark_it_zte_cust_extract`.`cust_type`', 'Table(s) utilisées': 'cdr.spark_it_zte_cust_extract'}, 'parent_id': {'Alias/Projection': 'parent_id', 'Colonnes détectées': ['parent_id'], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': '`spark_it_zte_cust_extract`.`parent_id`', 'Table(s) utilisées': 'cdr.spark_it_zte_cust_extract'}, 'created_date': {'Alias/Projection': 'created_date', 'Colonnes détectées': ['created_date'], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': '`spark_it_zte_acct_extract`.`created_date`', 'Table(s) utilisées': 'cdr.spark_it_zte_acct_extract'}, 'cust_update_date': {'Alias/Projection': 'cust_update_date', 'Colonnes détectées': ['update_date'], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': '`cust`.`update_date`', 'Table(s) utilisées': 'cdr.spark_it_zte_cust_extract, cdr.spark_it_zte_acct_extract, cdr.spark_it_zte_bal_extract, cdr.spark_it_zte_acc_nbr_extract, cdr.spark_it_zte_subs_extract, cdr.spark_it_zte_prod_extract, cdr.spark_it_zte_price_plan_extract, dim.dt_balance_type_item'}, 'cust_state': {'Alias/Projection': 'cust_state', 'Colonnes détectées': ['state'], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': '`cust`.`state`', 'Table(s) utilisées': 'cdr.spark_it_zte_cust_extract, cdr.spark_it_zte_acct_extract, cdr.spark_it_zte_bal_extract, cdr.spark_it_zte_acc_nbr_extract, cdr.spark_it_zte_subs_extract, cdr.spark_it_zte_prod_extract, cdr.spark_it_zte_price_plan_extract, dim.dt_balance_type_item'}, 'cust_state_date': {'Alias/Projection': 'cust_state_date', 'Colonnes détectées': ['state_date'], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': '`cust`.`state_date`', 'Table(s) utilisées': 'cdr.spark_it_zte_cust_extract, cdr.spark_it_zte_acct_extract, cdr.spark_it_zte_bal_extract, cdr.spark_it_zte_acc_nbr_extract, cdr.spark_it_zte_subs_extract, cdr.spark_it_zte_prod_extract, cdr.spark_it_zte_price_plan_extract, dim.dt_balance_type_item'}, 'cust_code': {'Alias/Projection': 'cust_code', 'Colonnes détectées': ['cust_code'], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': '`spark_it_zte_cust_extract`.`cust_code`', 'Table(s) utilisées': 'cdr.spark_it_zte_cust_extract'}, 'prod_created_date': {'Alias/Projection': 'prod_created_date', 'Colonnes détectées': ['created_date'], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': '`prod`.`created_date`', 'Table(s) utilisées': 'cdr.spark_it_zte_cust_extract, cdr.spark_it_zte_acct_extract, cdr.spark_it_zte_bal_extract, cdr.spark_it_zte_acc_nbr_extract, cdr.spark_it_zte_subs_extract, cdr.spark_it_zte_prod_extract, cdr.spark_it_zte_price_plan_extract, dim.dt_balance_type_item'}, 'block_reason': {'Alias/Projection': 'block_reason', 'Colonnes détectées': ['block_reason'], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': '`spark_it_zte_prod_extract`.`block_reason`', 'Table(s) utilisées': 'cdr.spark_it_zte_prod_extract'}, 'completed_date': {'Alias/Projection': 'completed_date', 'Colonnes détectées': ['completed_date'], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': '`spark_it_zte_prod_extract`.`completed_date`', 'Table(s) utilisées': 'cdr.spark_it_zte_prod_extract'}, 'prod_prod_state': {'Alias/Projection': 'prod_prod_state', 'Colonnes détectées': ['prod_state', 'prod_state', 'prod_state', 
'prod_state', 'prod_state', 'prod_state', 'block_reason', 'prod_state', 'block_reason'], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': "(CASE WHEN `prod`.`prod_state` = 'G' THEN 'VALID' WHEN `prod`.`prod_state` = 'A' THEN 'ACTIVE' WHEN (`prod`.`prod_state` = 'D' OR (`prod`.`prod_state` = 'E' AND `prod`.`block_reason` = '20000000000000')) THEN 'INACTIVE' WHEN (`prod`.`prod_state` = 'E' AND `prod`.`block_reason` <> '20000000000000') THEN 'DEACTIVATED' WHEN `prod`.`prod_state` = 'B' THEN 'TERMINATED' ELSE `prod`.`prod_state` END)", 'Table(s) utilisées': 'cdr.spark_it_zte_cust_extract, cdr.spark_it_zte_acct_extract, cdr.spark_it_zte_bal_extract, cdr.spark_it_zte_acc_nbr_extract, cdr.spark_it_zte_subs_extract, cdr.spark_it_zte_prod_extract, cdr.spark_it_zte_price_plan_extract, dim.dt_balance_type_item'}, 'prod_prod_state_date': {'Alias/Projection': 'prod_prod_state_date', 'Colonnes détectées': ['prod_state_date'], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': '`prod`.`prod_state_date`', 'Table(s) utilisées': 'cdr.spark_it_zte_cust_extract, cdr.spark_it_zte_acct_extract, cdr.spark_it_zte_bal_extract, cdr.spark_it_zte_acc_nbr_extract, cdr.spark_it_zte_subs_extract, cdr.spark_it_zte_prod_extract, cdr.spark_it_zte_price_plan_extract, dim.dt_balance_type_item'}, 'prod_update_date': {'Alias/Projection': 'prod_update_date', 'Colonnes 
détectées': ['update_date'], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': '`prod`.`update_date`', 'Table(s) utilisées': 'cdr.spark_it_zte_cust_extract, cdr.spark_it_zte_acct_extract, cdr.spark_it_zte_bal_extract, cdr.spark_it_zte_acc_nbr_extract, cdr.spark_it_zte_subs_extract, cdr.spark_it_zte_prod_extract, cdr.spark_it_zte_price_plan_extract, dim.dt_balance_type_item'}, 'prod_state': {'Alias/Projection': 'prod_state', 'Colonnes détectées': ['prod_state'], 'agg': [], 'Opérations arithmétiques': 
[], 'Formule SQL': '`spark_it_zte_prod_extract`.`prod_state`', 'Table(s) utilisées': 'cdr.spark_it_zte_prod_extract'}, 'prod_state_date': {'Alias/Projection': 'prod_state_date', 'Colonnes détectées': ['prod_state_date'], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': '`spark_it_zte_prod_extract`.`prod_state_date`', 'Table(s) utilisées': 'cdr.spark_it_zte_prod_extract'}, 'price_plan_name': {'Alias/Projection': 'price_plan_name', 'Colonnes détectées': ['price_plan_name'], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': '`spark_it_zte_price_plan_extract`.`price_plan_name`', 'Table(s) utilisées': 'cdr.spark_it_zte_price_plan_extract'}, 'main_balance': {'Alias/Projection': 'main_balance', 'Colonnes détectées': [], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': 'NULL', 'Table(s) utilisées': 'dim.dt_balance_type_item, 
cdr.spark_it_zte_bal_extract'}, 'promo_balance': {'Alias/Projection': 'promo_balance', 'Colonnes détectées': [], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': 
'NULL', 'Table(s) utilisées': 'dim.dt_balance_type_item, cdr.spark_it_zte_bal_extract'}, 'main_balance_eff_date': 

{'Alias/Projection': 'main_balance_eff_date', 'Colonnes détectées': ['eff_date', 'acct_res_rating_type'], 'agg': ['MAX'], 'Opérations arithmétiques': [], 'Formule SQL': "MAX(CASE WHEN `dt_bal`.`acct_res_rating_type` = 'MB' THEN 
`bal`.`eff_date` ELSE NULL END)", 'Table(s) utilisées': 'dim.dt_balance_type_item, cdr.spark_it_zte_bal_extract'}, 'main_balance_exp_date': {'Alias/Projection': 'main_balance_exp_date', 'Colonnes détectées': ['exp_date', 'acct_res_rating_type'], 'agg': ['MAX'], 'Opérations arithmétiques': [], 'Formule SQL': "MAX(CASE WHEN `dt_bal`.`acct_res_rating_type` = 'MB' THEN `bal`.`exp_date` ELSE NULL END)", 'Table(s) utilisées': 'dim.dt_balance_type_item, cdr.spark_it_zte_bal_extract'}, 'promo_balance_eff_date': {'Alias/Projection': 'promo_balance_eff_date', 'Colonnes détectées': ['eff_date', 'acct_res_rating_type'], 'agg': ['MAX'], 'Opérations arithmétiques': [], 'Formule SQL': "MAX(CASE WHEN `dt_bal`.`acct_res_rating_type` = 'PB' THEN `bal`.`eff_date` ELSE NULL END)", 'Table(s) utilisées': 'dim.dt_balance_type_item, cdr.spark_it_zte_bal_extract'}, 'promo_balance_exp_date': {'Alias/Projection': 'promo_balance_exp_date', 'Colonnes détectées': ['exp_date', 'acct_res_rating_type'], 'agg': ['MAX'], 'Opérations arithmétiques': [], 'Formule SQL': "MAX(CASE WHEN `dt_bal`.`acct_res_rating_type` = 'PB' THEN `bal`.`exp_date` ELSE NULL END)", 'Table(s) utilisées': 'dim.dt_balance_type_item, cdr.spark_it_zte_bal_extract'}, 'acct_update_date': {'Alias/Projection': 'acct_update_date', 'Colonnes détectées': ['update_date'], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': '`acct`.`update_date`', 'Table(s) utilisées': 'cdr.spark_it_zte_cust_extract, cdr.spark_it_zte_acct_extract, cdr.spark_it_zte_bal_extract, cdr.spark_it_zte_acc_nbr_extract, cdr.spark_it_zte_subs_extract, cdr.spark_it_zte_prod_extract, cdr.spark_it_zte_price_plan_extract, dim.dt_balance_type_item'}, 'acct_created_date': {'Alias/Projection': 'acct_created_date', 'Colonnes détectées': ['created_date'], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': '`acct`.`created_date`', 'Table(s) utilisées': 'cdr.spark_it_zte_cust_extract, cdr.spark_it_zte_acct_extract, cdr.spark_it_zte_bal_extract, cdr.spark_it_zte_acc_nbr_extract, cdr.spark_it_zte_subs_extract, cdr.spark_it_zte_prod_extract, cdr.spark_it_zte_price_plan_extract, dim.dt_balance_type_item'}, 'gross_main_balance': {'Alias/Projection': 'gross_main_balance', 'Colonnes détectées': ['acct_res_rating_type', 'gross_bal'], 'agg': ['SUM'], 'Opérations arithmétiques': ['/'], 'Formule SQL': "SUM(CASE WHEN `dt_bal`.`acct_res_rating_type` = 'MB' THEN 
-COALESCE(`bal`.`gross_bal`, 0) / 100 ELSE 0 END)", 'Table(s) utilisées': 'dim.dt_balance_type_item, cdr.spark_it_zte_bal_extract'}, 'consume_main_balance': {'Alias/Projection': 'consume_main_balance', 'Colonnes détectées': ['acct_res_rating_type', 'consume_bal'], 'agg': ['SUM'], 'Opérations arithmétiques': ['/'], 'Formule SQL': "SUM(CASE WHEN `dt_bal`.`acct_res_rating_type` = 'MB' THEN -COALESCE(`bal`.`consume_bal`, 0) / 100 ELSE 0 END)", 'Table(s) utilisées': 'dim.dt_balance_type_item, cdr.spark_it_zte_bal_extract'}, 'gross_promo_balance': {'Alias/Projection': 'gross_promo_balance', 'Colonnes détectées': ['acct_res_rating_type', 'gross_bal'], 'agg': ['SUM'], 'Opérations arithmétiques': ['/'], 'Formule SQL': "SUM(CASE WHEN `dt_bal`.`acct_res_rating_type` = 'PB' THEN -COALESCE(`bal`.`gross_bal`, 0) / 100 ELSE 0 END)", 'Table(s) utilisées': 'dim.dt_balance_type_item, cdr.spark_it_zte_bal_extract'}, 'consume_promo_balance': {'Alias/Projection': 'consume_promo_balance', 'Colonnes détectées': ['acct_res_rating_type', 'consume_bal'], 'agg': ['SUM'], 'Opérations arithmétiques': ['/'], 'Formule SQL': "SUM(CASE WHEN `dt_bal`.`acct_res_rating_type` = 'PB' THEN -COALESCE(`bal`.`consume_bal`, 0) / 100 ELSE 0 END)", 'Table(s) utilisées': 'dim.dt_balance_type_item, cdr.spark_it_zte_bal_extract'}, 'reserve_promo_balance': {'Alias/Projection': 'reserve_promo_balance', 'Colonnes détectées': ['acct_res_rating_type', 'reserve_bal'], 'agg': ['SUM'], 'Opérations arithmétiques': ['/'], 'Formule SQL': "SUM(CASE WHEN `dt_bal`.`acct_res_rating_type` = 'PB' THEN -COALESCE(`bal`.`reserve_bal`, 0) / 100 ELSE 0 END)", 'Table(s) utilisées': 'dim.dt_balance_type_item, cdr.spark_it_zte_bal_extract'}, 'reserve_main_balance': {'Alias/Projection': 'reserve_main_balance', 'Colonnes détectées': ['acct_res_rating_type', 'reserve_bal'], 'agg': ['SUM'], 'Opérations arithmétiques': ['/'], 'Formule SQL': "SUM(CASE WHEN `dt_bal`.`acct_res_rating_type` = 'MB' THEN -COALESCE(`bal`.`reserve_bal`, 0) / 100 ELSE 0 END)", 'Table(s) utilisées': 'dim.dt_balance_type_item, cdr.spark_it_zte_bal_extract'}, 'bundle_money_inter': {'Alias/Projection': 'bundle_money_inter', 'Colonnes détectées': ['acct_res_id', 'reserve_bal', 'consume_bal', 'gross_bal'], 'agg': ['SUM'], 'Opérations arithmétiques': ['-', '/'], 'Formule SQL': 'SUM(CASE WHEN `bal`.`acct_res_id` = 30 THEN -COALESCE(`bal`.`gross_bal`, 0) / 100 - 
COALESCE(`bal`.`consume_bal`, 0) / 100 - COALESCE(`bal`.`reserve_bal`, 0) / 100 ELSE 0 END)', 'Table(s) utilisées': 'dim.dt_balance_type_item, cdr.spark_it_zte_bal_extract'}, 'bundle_offnet_money': {'Alias/Projection': 'bundle_offnet_money', 'Colonnes détectées': ['acct_res_id', 'reserve_bal', 'consume_bal', 'gross_bal'], 'agg': ['SUM'], 'Opérations arithmétiques': ['-', '/'], 'Formule SQL': 'SUM(CASE WHEN `bal`.`acct_res_id` = 45 THEN -COALESCE(`bal`.`gross_bal`, 0) / 100 - COALESCE(`bal`.`consume_bal`, 0) 
/ 100 - COALESCE(`bal`.`reserve_bal`, 0) / 100 ELSE 0 END)', 'Table(s) utilisées': 'dim.dt_balance_type_item, cdr.spark_it_zte_bal_extract'}, 'main_balance_real': {'Alias/Projection': 'main_balance_real', 'Colonnes détectées': ['acct_res_id', 'reserve_bal', 'consume_bal', 'gross_bal'], 'agg': ['SUM'], 'Opérations arithmétiques': ['-', '/'], 'Formule SQL': 'SUM(CASE WHEN `bal`.`acct_res_id` = 1 THEN -COALESCE(`bal`.`gross_bal`, 0) / 100 - COALESCE(`bal`.`consume_bal`, 0) / 100 - COALESCE(`bal`.`reserve_bal`, 
0) / 100 ELSE 0 END)', 'Table(s) utilisées': 'dim.dt_balance_type_item, cdr.spark_it_zte_bal_extract'}, 'promo_onnet_special': {'Alias/Projection': 'promo_onnet_special', 
'Colonnes détectées': ['acct_res_id', 'reserve_bal', 'consume_bal', 'gross_bal'], 'agg': ['SUM'], 'Opérations arithmétiques': ['-', '/'], 'Formule SQL': 'SUM(CASE WHEN `bal`.`acct_res_id` = 27 THEN -COALESCE(`bal`.`gross_bal`, 0) / 100 - COALESCE(`bal`.`consume_bal`, 0) / 100 - COALESCE(`bal`.`reserve_bal`, 0) / 100 ELSE 0 END)', 'Table(s) 
utilisées': 'dim.dt_balance_type_item, cdr.spark_it_zte_bal_extract'}, 
'loan_balance': {'Alias/Projection': 'loan_balance', 'Colonnes détectées':
 ['acct_res_id', 'reserve_bal', 'consume_bal', 'gross_bal'], 'agg': ['SUM'],
  'Opérations arithmétiques': ['-', '/'], 'Formule SQL':
   'SUM(CASE WHEN `bal`.`acct_res_id` = 20 THEN -COALESCE(`bal`.`gross_bal`, 0) / 
   100 - COALESCE(`bal`.`consume_bal`, 0) / 100 - COALESCE(`bal`.`reserve_bal`, 0) / 100 ELSE 0 END)',
    'Table(s) utilisées': 'dim.dt_balance_type_item, cdr.spark_it_zte_bal_extract'},
     'main_sassaye': {'Alias/Projection': 'main_sassaye', 'Colonnes détectées': 
     ['acct_res_id', 'reserve_bal', 'consume_bal', 'gross_bal'], 'agg': ['SUM'], 'Opérations arithmétiques': ['-', '/'],
      'Formule SQL': 'SUM(CASE WHEN `bal`.`acct_res_id` = 21 THEN -COALESCE(`bal`.`gross_bal`, 0) / 
      100 - COALESCE(`bal`.`consume_bal`, 0) / 100 - COALESCE(`bal`.`reserve_bal`, 0) / 100 ELSE 0 END)',
       'Table(s) utilisées': 'dim.dt_balance_type_item, cdr.spark_it_zte_bal_extract'}, 'promo_sassaye':
        {'Alias/Projection': 'promo_sassaye', 'Colonnes détectées': ['acct_res_id', 'reserve_bal', 'consume_bal', 'gross_bal'],
         'agg': ['SUM'], 'Opérations arithmétiques': ['-', '/'],
          'Formule SQL': 'SUM(CASE WHEN `bal`.`acct_res_id` = 22 THEN -COALESCE(`bal`.`gross_bal`, 0) / 
          100 - COALESCE(`bal`.`consume_bal`, 0) / 100 - COALESCE(`bal`.`reserve_bal`, 0) / 100 ELSE 0 END)',
           'Table(s) utilisées': 'dim.dt_balance_type_item, cdr.spark_it_zte_bal_extract'}, 
           'promo': {'Alias/Projection': 'promo', 'Colonnes détectées': ['acct_res_id', 'reserve_bal', 'consume_bal', 'gross_bal'], 'agg': ['SUM'], 'Opérations arithmétiques': ['-', '/'], 'Formule SQL': 'SUM(CASE WHEN `bal`.`acct_res_id` = 2 THEN -COALESCE(`bal`.`gross_bal`, 0) / 100 - COALESCE(`bal`.`consume_bal`, 0) / 100 - COALESCE(`bal`.`reserve_bal`, 0) / 100 ELSE 0 END)', 'Table(s) utilisées': 'dim.dt_balance_type_item, cdr.spark_it_zte_bal_extract'}, 'promo_onnet': {'Alias/Projection': 'promo_onnet', 'Colonnes détectées': ['acct_res_id', 'reserve_bal', 'consume_bal', 'gross_bal'], 'agg': ['SUM'], 'Opérations arithmétiques': ['-', '/'], 'Formule SQL': 'SUM(CASE WHEN `bal`.`acct_res_id` = 3 THEN -COALESCE(`bal`.`gross_bal`, 0) / 100 - COALESCE(`bal`.`consume_bal`, 0) / 100 - COALESCE(`bal`.`reserve_bal`, 0) / 100 ELSE 0 END)', 'Table(s) utilisées': 'dim.dt_balance_type_item, cdr.spark_it_zte_bal_extract'}, 'set_voiceonnet': {'Alias/Projection': 'set_voiceonnet', 'Colonnes détectées': ['acct_res_id', 'reserve_bal', 'consume_bal', 'gross_bal'], 'agg': ['SUM'], 'Opérations arithmétiques': ['-', '/'], 'Formule SQL': 'SUM(CASE WHEN `bal`.`acct_res_id` = 15 THEN -COALESCE(`bal`.`gross_bal`, 0) / 100 - COALESCE(`bal`.`consume_bal`, 0) / 100 - COALESCE(`bal`.`reserve_bal`, 0) / 100 ELSE 0 END)', 'Table(s) utilisées': 'dim.dt_balance_type_item, cdr.spark_it_zte_bal_extract'}, 'set_promo': {'Alias/Projection': 'set_promo', 'Colonnes détectées': ['acct_res_id', 'reserve_bal', 'consume_bal', 'gross_bal'], 'agg': ['SUM'], 'Opérations arithmétiques': ['-', '/'], 'Formule SQL': 'SUM(CASE WHEN `bal`.`acct_res_id` = 16 THEN -COALESCE(`bal`.`gross_bal`, 0) / 100 - COALESCE(`bal`.`consume_bal`, 0) / 100 - COALESCE(`bal`.`reserve_bal`, 0) / 100 ELSE 0 END)', 'Table(s) utilisées': 'dim.dt_balance_type_item, cdr.spark_it_zte_bal_extract'}, 'prod_status': {'Alias/Projection': 'prod_status', 'Colonnes détectées': ['prod_state'], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': '`prod`.`prod_state`', 'Table(s) utilisées': 'cdr.spark_it_zte_cust_extract, cdr.spark_it_zte_acct_extract, cdr.spark_it_zte_bal_extract, cdr.spark_it_zte_acc_nbr_extract, cdr.spark_it_zte_subs_extract, cdr.spark_it_zte_prod_extract, cdr.spark_it_zte_price_plan_extract, dim.dt_balance_type_item'}, '*': {'Alias/Projection': '*', 'Colonnes détectées': ['*'], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': '`bal`.*', 'Table(s) utilisées': 'cdr.spark_it_zte_bal_extract'}, 'msisdn': {'Alias/Projection': 'msisdn', 'Colonnes détectées': ['msisdn'], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': '`spark_ft_client_site_traffic_day`.`msisdn`', 'Table(s) utilisées': 'mon.spark_ft_client_site_traffic_day'}, 'site_a': {'Alias/Projection': 'site_a', 'Colonnes détectées': ['site_name'], 'agg': ['MAX'], 'Opérations arithmétiques': [], 'Formule SQL': 'MAX(`a`.`site_name`)', 'Table(s) utilisées': 'mon.spark_ft_client_last_site_day, mon.spark_ft_client_site_traffic_day'}, 'site_b': {'Alias/Projection': 'site_b', 'Colonnes détectées': ['site_name'], 'agg': ['MAX'], 'Opérations arithmétiques': [], 'Formule SQL': 'MAX(`b`.`site_name`)', 'Table(s) utilisées': 'mon.spark_ft_client_last_site_day, mon.spark_ft_client_site_traffic_day'}, 'ci': {'Alias/Projection': 'ci', 'Colonnes détectées': ['ci'], 'agg': ['MAX'], 'Opérations arithmétiques': [], 'Formule SQL': 'MAX(`spark_dt_gsm_cell_code`.`ci`)', 'Table(s) utilisées': 'dim.spark_dt_gsm_cell_code'}, 'site_name': {'Alias/Projection': 'site_name', 'Colonnes détectées': ['msisdn', 'site_name', 'refresh_date'], 'agg': ['FIRSTVALUE'], 'Opérations arithmétiques': [], 'Formule SQL': 'FIRST_VALUE(`spark_ft_client_site_traffic_day`.`site_name`) OVER (PARTITION BY `spark_ft_client_site_traffic_day`.`msisdn` ORDER BY `spark_ft_client_site_traffic_day`.`refresh_date` DESC)', 'Table(s) utilisées': 'mon.spark_ft_client_site_traffic_day'}, '_col_0': {'Alias/Projection': '_col_0', 'Colonnes détectées': ['event_date'], 'agg': ['MAX'], 'Opérations 
arithmétiques': [], 'Formule SQL': 'MAX(`ft_bscs_contract`.`event_date`)',
 'Table(s) utilisées': 'mon.ft_bscs_contract'}, 'subs_acc_nbr': {'Alias/Projection': 'subs_acc_nbr',
  'Colonnes détectées': ['acc_nbr'], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': 
  '`spark_it_zte_subs_extract`.`acc_nbr`', 'Table(s) utilisées': 'cdr.spark_it_zte_subs_extract'}, 
  'subs_acct_id': {'Alias/Projection': 'subs_acct_id', 'Colonnes détectées': ['acct_id'], 'agg': [],
   'Opérations arithmétiques': [], 'Formule SQL': '`spark_it_zte_subs_extract`.`acct_id`', 
   'Table(s) utilisées': 'cdr.spark_it_zte_subs_extract'},
    'subs_id': {'Alias/Projection': 'subs_id', 'Colonnes détectées': ['subs_id'], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': '`spark_it_zte_subs_extract`.`subs_id`', 'Table(s) utilisées': 'cdr.spark_it_zte_subs_extract'}, 'rn_subs': {'Alias/Projection': 'rn_subs', 'Colonnes détectées': ['subs_id', 'imsi'], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': 'ROW_NUMBER() OVER (PARTITION BY `spark_it_zte_subs_extract`.`subs_id` ORDER BY `spark_it_zte_subs_extract`.`imsi` DESC)', 'Table(s) utilisées': 'cdr.spark_it_zte_subs_extract'}, 'state': {'Alias/Projection': 'state', 'Colonnes détectées': ['state'], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': '`spark_it_zte_prod_extract`.`state`', 'Table(s) utilisées': 'cdr.spark_it_zte_prod_extract'}, 'prod_id': {'Alias/Projection': 'prod_id', 'Colonnes détectées': ['prod_id'], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': '`spark_it_zte_prod_extract`.`prod_id`', 'Table(s) utilisées': 'cdr.spark_it_zte_prod_extract'}, 'sp_id': {'Alias/Projection': 'sp_id', 'Colonnes détectées': ['sp_id'], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': '`spark_it_zte_prod_extract`.`sp_id`', 'Table(s) utilisées': 'cdr.spark_it_zte_prod_extract'}, 'rn': {'Alias/Projection': 'rn', 'Colonnes détectées': ['acct_id', 'acct_res_id', 'update_date'], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': 'ROW_NUMBER() OVER (PARTITION BY `bal`.`acct_id`, `bal`.`acct_res_id` ORDER BY `bal`.`update_date` DESC)', 
'Table(s) utilisées': 'cdr.spark_it_zte_bal_extract'}, 'acct_res_id': {'Alias/Projection': 'acct_res_id', 
'Colonnes détectées': ['acct_res_id'], 'agg': [], 
'Opérations arithmétiques': [], 
'Formule SQL': '`dt_balance_type_item`.`acct_res_id`', 'Table(s) utilisées': 'dim.dt_balance_type_item'}, 
'acct_res_rating_type': {'Alias/Projection': 'acct_res_rating_type', 'Colonnes détectées': ['acct_res_rating_type'], 
'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': '`dt_balance_type_item`.`acct_res_rating_type`', 
'Table(s) utilisées': 'dim.dt_balance_type_item'}},
 'position': 3}, 
'C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\IT\\IN_ZTE\\EXTRACT\\insert_into_spark_it_price_plan_extract.hql': 
{'C:\\Users\\YBQB7360\\Downloads\\HDFS\\HDFS\\PROD\\SCRIPTS\\IT\\IN_ZTE\\EXTRACT\\insert_into_spark_it_price_plan_extract.hql':
 {'price_plan_id': {'Alias/Projection': 'price_plan_id', 'Colonnes détectées': ['price_plan_id'], 'agg': [],
  'Opérations arithmétiques': [], 'Formule SQL': '`c`.`price_plan_id`', 'Table(s) utilisées': 'cdr.tt_zte_price_plan_extract, 
  cdr.spark_it_zte_price_plan_extract'}, 'apply_level': {'Alias/Projection': 'apply_level', 'Colonnes détectées': ['apply_level'], 
  'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': '`c`.`apply_level`', 
  'Table(s) utilisées': 'cdr.tt_zte_price_plan_extract, cdr.spark_it_zte_price_plan_extract'}, 
  'price_plan_name': {'Alias/Projection': 'price_plan_name', 'Colonnes détectées': ['price_plan_name'],
   'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': '`c`.`price_plan_name`', 'Table(s) utilisées': 
   'cdr.tt_zte_price_plan_extract, cdr.spark_it_zte_price_plan_extract'}, 
'comments': {'Alias/Projection': 'comments', 'Colonnes détectées': ['comments'], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': '`c`.`comments`', 'Table(s) utilisées': 'cdr.tt_zte_price_plan_extract, cdr.spark_it_zte_price_plan_extract'}, 'state': {'Alias/Projection': 'state', 'Colonnes détectées': ['state'], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': '`c`.`state`', 'Table(s) utilisées': 'cdr.tt_zte_price_plan_extract, cdr.spark_it_zte_price_plan_extract'}, 'state_date': {'Alias/Projection': 'state_date', 'Colonnes détectées': ['state_date'], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': '`c`.`state_date`', 'Table(s) utilisées': 'cdr.tt_zte_price_plan_extract, cdr.spark_it_zte_price_plan_extract'}, 'priority': {'Alias/Projection': 'priority', 'Colonnes détectées': ['priority'], 'agg': [], 'Opérations arithtectées': ['priority'], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': '`c`.`priority`', 'Table(s) utiliséesprice_plan_extract'}, 'price_plan_code': {'Alias/Pro': 'cdr.tt_zte_price_plan_extract, cdr.spark_it_zte_price_plan_extract'}, 'price_plan_code': {'Alias/Projection': 'pricmule SQL': '`c`.`price_plan_code`', 'Table(s) utilise_plan_code', 'Colonnes détectées': ['price_plan_code'], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': '`c`lonnes détectées': ['sp_id'], 'agg': [], 'Opérations.`price_plan_code`', 'Table(s) utilisées': 'cdr.tt_zte_price_plan_extract, cdr.spark_it_zte_price_plan_extract'}, 'sp_ite_price_plan_extract'}, 'warn_level': {'Alias/Projed': {'Alias/Projection': 'sp_id', 'Colonnes détectées': ['sp_id'], 'agg': [], 'Opérations arithmétiques': [], 'Formule `c`.`warn_level`', 'Table(s) utilisées': 'cdr.tt_zte
SQL': '`c`.`sp_id`', 'Table(s) utilisées': 'cdr.tt_zte_price_plan_extract, cdr.spark_it_zte_price_plan_extract'}, 'warname', 'Colonnes détectées': ['original_file_name'], _level': {'Alias/Projection': 'warn_level', 'Colonnes détectées': ['warn_level'], 'agg': [], 'Opérations arithmétiques'_price_plan_extract, cdr.spark_it_zte_price_plan_ext: [], 'Formule SQL': '`c`.`warn_level`', 'Table(s) utilisées': 'cdr.tt_zte_price_plan_extract, cdr.spark_it_zte_price_pes': [], 'Formule SQL': 'CURRENT_TIMESTAMP()', 'Tabllan_extract'}, 'original_file_name': {'Alias/Projection': 'original_file_name', 'Colonnes détectées': ['original_file_nrojection': 'original_file_date', 'Colonnes détectéeame'], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': '`c`.`original_file_name`', 'Table(s) utilisées': 'cdrTAMP(SUBSTRING(`c`.`original_file_name`, -12, 8), 'y.tt_zte_price_plan_extract, cdr.spark_it_zte_price_plan_extract'}, 'insert_date': {'Alias/Projection': 'insert_date', ' {'Alias/Projection': 'file_name', 'Colonnes détectéColonnes détectées': [], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': 'CURRENT_TIMESTAMP()', 'Table(s) utit`.`original_file_name`', 'Table(s) utilisées': 'cdrlisées': 'cdr.tt_zte_price_plan_extract, cdr.spark_it_zte_price_plan_extract'}, 'original_file_date': {'Alias/Projection': 'original_file_date', 'Colonnes détectées': ['original_file_name'], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': "TO_DATE(FROM_UNIXTIME(UNIX_TIMESTAMP(SUBSTRING(`c`.`original_file_name`, -12, 8), 'yyyyMMdd')))", 'Table(s) utilisées': 'cdr.tt_zte_price_plan_extract, cdr.spark_it_zte_price_plan_extract'}, 'file_name': {'Alias/Projection': 'file_name', 'Colonnes détectées': ['original_file_name'], 'agg': [], 'Opérations arithmétiques': [], 'Formule SQL': '`spark_it_zte_price